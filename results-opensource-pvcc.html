<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en-us">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Snyk test report</title>
  <meta name="description" content=" known vulnerabilities found in .">
  <base target="_blank">
  <link rel="icon" type="image/png" href="https://res.cloudinary.com/snyk/image/upload/v1468845142/favicon/favicon.png"
    sizes="194x194">
  <link rel="shortcut icon" href="https://res.cloudinary.com/snyk/image/upload/v1468845142/favicon/favicon.ico">
  <style type="text/css">
  
    body {
      -moz-font-feature-settings: "pnum";
      -webkit-font-feature-settings: "pnum";
      font-variant-numeric: proportional-nums;
      display: flex;
      flex-direction: column;
      font-feature-settings: "pnum";
      font-size: 100%;
      line-height: 1.5;
      min-height: 100vh;
      -webkit-text-size-adjust: 100%;
      margin: 0;
      padding: 0;
      color: #393842;
      font-family: -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Ubuntu, roboto, noto, arial, sans-serif;
    }
  
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-weight: 500;
    }
  
    a,
    a:link,
    a:visited {
      border-bottom: 1px solid #4b45a9;
      text-decoration: none;
      color: #4b45a9;
    }
  
    a:hover,
    a:focus,
    a:active {
      border-bottom: 1px solid #4b45a9;
    }
  
    hr {
      border: none;
      margin: 1em 0;
      border-top: 1px solid #c5c5c5;
    }
  
    ul {
      padding: 0 1em;
      margin: 1em 0;
    }
  
    code {
      background-color: #EEE;
      color: #333;
      padding: 0.25em 0.5em;
      border-radius: 0.25em;
    }
  
    pre {
      font-size: 14px;
    }
  
    pre code {
      padding: 10px;
      font-family: monospace;
      background-color: #393842;
      border-radius: 4px;
      color: #fff;
      display: block;
      white-space: pre-wrap;
      overflow-x: auto;
      max-width: 100%;
      min-width: 100px;
    }
  
    a code {
      border-radius: .125rem .125rem 0 0;
      padding-bottom: 0;
      color: #4b45a9;
    }
  
    a[href^="http://"]:after,
    a[href^="https://"]:after:not(.brand) {
      background-image: linear-gradient(transparent,transparent),url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20112%20109%22%3E%3Cg%20id%3D%22Page-1%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22link-external%22%3E%3Cg%20id%3D%22arrow%22%3E%3Cpath%20id%3D%22Line%22%20stroke%3D%22%234B45A9%22%20stroke-width%3D%2215%22%20d%3D%22M88.5%2021l-43%2042.5%22%20stroke-linecap%3D%22square%22%2F%3E%3Cpath%20id%3D%22Triangle%22%20fill%3D%22%234B45A9%22%20d%3D%22M111.2%200v50L61%200z%22%2F%3E%3C%2Fg%3E%3Cpath%20id%3D%22square%22%20fill%3D%22%234B45A9%22%20d%3D%22M66%2015H0v94h94V44L79%2059v35H15V30h36z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
      background-repeat: no-repeat;
      background-size: .75rem;
      content: "";
      display: inline-block;
      height: .75rem;
      margin-left: .25rem;
      width: .75rem;
    }
  
  
  /* Layout */
  
    [class*=layout-container] {
      margin: 0 auto;
      max-width: 71.25em;
      padding: 20px;
      position: relative;
    }
    .layout-container--short {
      padding-top: 0;
      padding-bottom: 0;
      max-width: 48.75em;
    }
  
    .layout-container--short:after {
      display: block;
      content: "";
      clear: both;
    }
  
  /* Header */
  
    .header {
      padding-bottom: 1px;
    }
  
    .paths {
      margin-left: 8px;
      font-size:14px;
    }
  
    .project__header {
      background-color: #4b45a9;
      background-image: linear-gradient(to right, #7530a6 0%, #461d9f 50%);
      color: #fff;
      }
  
    .project__header__title {
      overflow-wrap: break-word;
      word-wrap: break-word;
      word-break: break-all;
      margin-top: 0;
      margin-bottom: 12px;
    }
  
    .meta-count {
      display: inline-block;
      margin: 0 12px 6px 0;
      padding-right: 12px;
      font-size:14px;
    }
  
  /* Card */
  
    .card {
      background-color: #fff;
      border: 1px solid #c5c5c5;
      border-radius: .25rem;
      margin: 0 0 2em 0;
      position: relative;
      min-height: 40px;
      padding: 0;
    }
  
    .card .label {
      background-color: #767676;
      border: 2px solid #767676;
      color: white;
      padding: 0.25rem 0.75rem;
      font-size: 0.875rem;
      text-transform: uppercase;
      display: inline-block;
      margin: 0;
      border-radius: 0.25rem;
    }
  
    .card .label__text {
      vertical-align: text-top;
        font-weight: bold;
    }
  
    .card .label--critical {
      background-color: #AB1A1A;
      border-color: #AB1A1A;
    }
  
    .card .label--high {
      background-color: #CE5019;
      border-color: #CE5019;
    }
  
    .card .label--medium {
      background-color: #D68000;
      border-color: #D68000;
    }
  
    .card .label--low {
      background-color: #88879E;
      border-color: #88879E;
    }
  
    .severity--low {
      border-color: #88879E;
    }
  
    .severity--medium {
      border-color: #D68000;
    }
  
    .severity--high {
      border-color: #CE5019;
    }
  
    .severity--critical {
      border-color: #AB1A1A;
    }
  
    .card--vuln {
      padding-top: 4em;
    }
  
    .card--vuln .label {
      left: 0;
      position: absolute;
      top: 1.1em;
      padding-left: 1.9em;
      padding-right: 1.9em;
      border-radius: 0 0.25rem 0.25rem 0;
    }
  
    .card__section {
      background-color: #faf9fa
    }
  
    .card__section h2 {
      font-size: 22px;
      margin-bottom: 0.5em;
    }
  
    .card__section p {
      margin: 0 0 12px 0;
    }
  
    .card__meta {
      padding: 0;
      margin-top: 10px;
      font-size: 1.1em;
    }
  
    .card__meta__item {
      display: inline-block;
    }
  
    .card .card__meta__paths {
      font-size: 0.9em;
    }
  
    .card__title {
      font-size: 28px;
      margin-top: 0;
    }
  
    .card__cta p {
      margin: 0;
      text-align: right;
    }
  
  /* Styles by Andy */
  
  .brand, .brand:link, .brand:visited { display:inline-block; border:none; }
  .brand::after { background:none; }
  
  .test-meta { float:right; max-width:500px; opacity:.75; font-size:12px; text-align: right; }
  .test-meta .filepath { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .test-meta .timestamp { margin:0 0 6px }
  
  .report-summary { display:flex; justify-content: space-between; margin-bottom: 24px; }
  .header-wrap, .source-panel { align-self: center; }
  .severity-icon { display:inline-block; width:32px; height: 32px;  }
  .severity-icon.severity-icon--critical { background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iI0FCMUExQSIvPgo8cGF0aCBkPSJNMTkuNTYyNSAxOC4zMzk4SDIzLjA2NjRDMjIuOTk2MSAxOS40ODgzIDIyLjY3OTcgMjAuNTA3OCAyMi4xMTcyIDIxLjM5ODRDMjEuNTYyNSAyMi4yODkxIDIwLjc4NTIgMjIuOTg0NCAxOS43ODUyIDIzLjQ4NDRDMTguNzkzIDIzLjk4NDQgMTcuNTk3NyAyNC4yMzQ0IDE2LjE5OTIgMjQuMjM0NEMxNS4xMDU1IDI0LjIzNDQgMTQuMTI1IDI0LjA0NjkgMTMuMjU3OCAyMy42NzE5QzEyLjM5MDYgMjMuMjg5MSAxMS42NDg0IDIyLjc0MjIgMTEuMDMxMiAyMi4wMzEyQzEwLjQyMTkgMjEuMzIwMyA5Ljk1NzAzIDIwLjQ2MDkgOS42MzY3MiAxOS40NTMxQzkuMzE2NDEgMTguNDQ1MyA5LjE1NjI1IDE3LjMxNjQgOS4xNTYyNSAxNi4wNjY0VjE0Ljg4MjhDOS4xNTYyNSAxMy42MzI4IDkuMzIwMzEgMTIuNTAzOSA5LjY0ODQ0IDExLjQ5NjFDOS45ODQzOCAxMC40ODA1IDEwLjQ2MDkgOS42MTcxOSAxMS4wNzgxIDguOTA2MjVDMTEuNzAzMSA4LjE5NTMxIDEyLjQ0OTIgNy42NDg0NCAxMy4zMTY0IDcuMjY1NjJDMTQuMTgzNiA2Ljg4MjgxIDE1LjE1MjMgNi42OTE0MSAxNi4yMjI3IDYuNjkxNDFDMTcuNjQ0NSA2LjY5MTQxIDE4Ljg0MzggNi45NDkyMiAxOS44MjAzIDcuNDY0ODRDMjAuODA0NyA3Ljk4MDQ3IDIxLjU2NjQgOC42OTE0MSAyMi4xMDU1IDkuNTk3NjZDMjIuNjUyMyAxMC41MDM5IDIyLjk4MDUgMTEuNTM1MiAyMy4wODk4IDEyLjY5MTRIMTkuNTc0MkMxOS41MzUyIDEyLjAwMzkgMTkuMzk4NCAxMS40MjE5IDE5LjE2NDEgMTAuOTQ1M0MxOC45Mjk3IDEwLjQ2MDkgMTguNTc0MiAxMC4wOTc3IDE4LjA5NzcgOS44NTU0N0MxNy42Mjg5IDkuNjA1NDcgMTcuMDAzOSA5LjQ4MDQ3IDE2LjIyMjcgOS40ODA0N0MxNS42MzY3IDkuNDgwNDcgMTUuMTI1IDkuNTg5ODQgMTQuNjg3NSA5LjgwODU5QzE0LjI1IDEwLjAyNzMgMTMuODgyOCAxMC4zNTk0IDEzLjU4NTkgMTAuODA0N0MxMy4yODkxIDExLjI1IDEzLjA2NjQgMTEuODEyNSAxMi45MTggMTIuNDkyMkMxMi43NzczIDEzLjE2NDEgMTIuNzA3IDEzLjk1MzEgMTIuNzA3IDE0Ljg1OTRWMTYuMDY2NEMxMi43MDcgMTYuOTQ5MiAxMi43NzM0IDE3LjcyNjYgMTIuOTA2MiAxOC4zOTg0QzEzLjAzOTEgMTkuMDYyNSAxMy4yNDIyIDE5LjYyNSAxMy41MTU2IDIwLjA4NTlDMTMuNzk2OSAyMC41MzkxIDE0LjE1NjIgMjAuODgyOCAxNC41OTM4IDIxLjExNzJDMTUuMDM5MSAyMS4zNDM4IDE1LjU3NDIgMjEuNDU3IDE2LjE5OTIgMjEuNDU3QzE2LjkzMzYgMjEuNDU3IDE3LjUzOTEgMjEuMzM5OCAxOC4wMTU2IDIxLjEwNTVDMTguNDkyMiAyMC44NzExIDE4Ljg1NTUgMjAuNTIzNCAxOS4xMDU1IDIwLjA2MjVDMTkuMzYzMyAxOS42MDE2IDE5LjUxNTYgMTkuMDI3MyAxOS41NjI1IDE4LjMzOThaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K) }
  .severity-icon.severity-icon--high { background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iI0NFNTAxOSIvPgo8cGF0aCBkPSJNMjAuNDI5NyAxMy44ODY3VjE2LjYyODlIMTEuNTIzNFYxMy44ODY3SDIwLjQyOTdaTTEyLjU2NjQgNi45Mzc1VjI0SDkuMDUwNzhWNi45Mzc1SDEyLjU2NjRaTTIyLjkzNzUgNi45Mzc1VjI0SDE5LjQzMzZWNi45Mzc1SDIyLjkzNzVaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K) }
  .severity-icon.severity-icon--medium { background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iI0Q2ODAwMCIvPgo8cGF0aCBkPSJNOC42MTcxOSA2LjkzNzVIMTEuNTkzOEwxNS45NzY2IDE5LjQ2NDhMMjAuMzU5NCA2LjkzNzVIMjMuMzM1OUwxNy4xNzE5IDI0SDE0Ljc4MTJMOC42MTcxOSA2LjkzNzVaTTcuMDExNzIgNi45Mzc1SDkuOTc2NTZMMTAuNTE1NiAxOS4xNDg0VjI0SDcuMDExNzJWNi45Mzc1Wk0yMS45NzY2IDYuOTM3NUgyNC45NTMxVjI0SDIxLjQzNzVWMTkuMTQ4NEwyMS45NzY2IDYuOTM3NVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=) }
  .severity-icon.severity-icon--low { background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzg4ODc5RSIvPgo8cGF0aCBkPSJNMjIgMjEuMjU3OFYyNEgxMy40MTAyVjIxLjI1NzhIMjJaTTE0LjU0NjkgNi45Mzc1VjI0SDExLjAzMTJWNi45Mzc1SDE0LjU0NjlaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K) }
  .meta-count .severity-icon { float:left; width:24px; height:24px; margin-right:6px; background-size: 24px 24px; }
  
  .source-panel { text-align: right; }
  .source-panel__heading { display:block; margin-top:6px; text-transform:uppercase; color:#727184; font-size:12px; }
  .scan-coverage { max-width: 400px; padding:0; margin:12px 0 0; font-size:14px; }
  .scan-coverage .type { display:inline-block; list-style-type: none; padding:3px; margin:0 0 0 10px; }
  
  .card { padding:0; border-width:4px 1px 1px; border-color:#d3d3d9; border-radius: 4px 4px 0 0 }
  .card.severity--low { border-top-color: #88879E; }
  .card.severity--medium { border-top-color: #D68000; }
  .card.severity--high { border-top-color: #CE5019; }
  .card.severity--critical { border-top-color: #AB1A1A; }
  
  .card .fix-analysis { display:none }
  .card.show-fix .fix-analysis { display:block }
  .card.show-fix .dataflow { display:none }
  
  .card__header { padding:24px }
  .card__header__main { display:flex; }
  .card__header__main .severity-icon { margin-right:12px; }
  .card__meta { display:flex; align-items:flex-start; margin:0; list-style:none; }
  .card__meta__item { display:inline-block; padding-right:8px; border-right:1px solid #eee; margin-right: 8px; font-size:12px; color:#727184 }
  .card__meta__item:last-child { border:none; }
  .card .card__title { display:inline-block; margin:0; font-size:22px; font-weight:600; vertical-align: top;}
  
  .card__actions { display:flex; padding:2px; border:1px solid #d3d3d9; border-radius:20px; background-color:#fff;  margin-left: auto; }
  .card__action { align-self: center; padding:5px 15px; font-size:14px; cursor: pointer; transition: all .2s; }
  .card__action:hover { color: #4b45a1; }
  .card__action.is-selected { background-color:#4b45a1; color:#fff; border-radius:20px; }
  .severity--high .card-dataflow.is-selected { background-color:#CE5019 ; }
  .severity--medium .card-dataflow.is-selected { background-color:#D68000 ; }
  .severity--low .card-dataflow.is-selected { background-color:#88879E ; }
  
  .card__section {padding:24px; border-top: 1px solid #d3d3d9}
  
  .card__snippet { background-color: transparent; font-family: monospace; white-space: pre; margin: 1em 0px;  }
  
  .card__summary { position: relative; padding: 16px 24px; border: 1px solid #d3d3d9; border-left-width:4px; border-radius:2px; background-color:#fff; color:#393842; word-break: break-word; }
  .card__summary.severity--critical { border-left-color:#AB1A1A ; }
  .card__summary.severity--high { border-left-color:#CE5019 ; }
  .card__summary.severity--medium { border-left-color:#D68000 ; }
  .card__summary.severity--low { border-left-color:#88879E; }
  .card__summary .file-location { margin-top:12px; font-size:13px; color:#727184 }
  
  .dataflow { margin:12px 0 }
  .dataflow__item, .code-source { display: flex; padding:4px 8px; border:1px solid transparent; border-width: 1px 0; font-family: monospace; color:#393842; font-size:14px }
  .dataflow__item:hover { cursor:pointer; border-color: #eee; background-color:#fff; }
  .dataflow__item:hover .marker { background-color: #ffc905; }
  .dataflow__step, .dataflow__lineno, .code-lineno { align-self: flex-start; flex:0 0 50px; width: 50px; text-align: right; color:#727184; font-size:12px; }
  .dataflow__step  { flex:0 0 30px; width: 30px; }
  .dataflow__lineno { flex:0 0 60px;  padding:0 20px 0 0; }
  .dataflow__code { display:flex; align-self: flex-start; align-content: flex-start; flex-grow: 1; margin-right:40px; line-height:1; overflow:auto; }
  .dataflow__code h1, .dataflow__code h2, .dataflow__code h3, .dataflow__code h4, .dataflow__code h5, .dataflow__code h6, .dataflow__code strong, .dataflow__code b, .dataflow__code em, .dataflow__code i, .dataflow__code p  { padding:0; margin:0; font-family: monospace; color:#393842; font-size:14px; font-weight:400; font-style: normal;  } /* overriding html default styling within the code */
  .dataflow__code br { display:none  } /* overriding html default styling within the code */
  .dataflow__code .dataflow__codeprefix, .dataflow__code .dataflow__codesuffix { display:inline-block; margin:0; white-space:nowrap } 
  .dataflow__badge { align-self:flex-start; padding:2px 3px; border:1px solid #d3d3d9; border-radius:2px; margin-top:2px; background-color:#f4f4f6; font-size:11px; line-height:1; font-family: sans-serif; text-transform: uppercase; color:#646374 } 
  .dataflow__filename { padding:6px 12px; border:1px solid #eee; border-radius: 4px; margin:20px 0 10px; font-size:13px; color:#393842; background-color: #fff; }
  
  .marker { padding:2px 6px; border-radius:4px; background-color: rgba(0,0,0,.1); word-break: break-all; white-space: nowrap; }
  .marker.block { white-space: pre; line-height: 1.5; }
  
  .card .card__section h2, .card .card__section h3 { font-size:18px; } 
  .card__panel__heading { padding:5px 0; font-size:22px; font-weight: 600; }
  .heading-char { display: inline-block; width:22px; height:22px; border:1px solid #d3d3d9; border-radius:15px; margin-right:5px; color:#727184; font-size:14px; background-color:#fff; text-align: center; }
  
  .card__panel__markdown { font-size:14px; color:#393842; }
  .card__panel__markdown table { border-collapse: collapse; border:1px solid #d3d3d9; border-radius:3px; }
  .card__panel__markdown tbody { display: table-row-group; vertical-align: top; }
  .card__panel__markdown table td, .card__panel__markdown table th { min-width: 100px; padding:2px 5px; text-align: left; border-top:1px solid #d3d3d9; }
  .card__panel__markdown table td { background-color:#fff; font-size:14px; line-height: 1.4; }
  
  .is-hidden { display:none; }
  
  @media print { 
    /* All your print styles go here */
     .card .fix-analysis { display:block; }
     .card__section { background-color: none; }
     .project__header, .card__actions, .severity-icon { display: none; }
     .marker { border:1px solid #555; margin:-1px 0; background: transparent }
  }
  
  </style>
  <style type="text/css">
    .metatable {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      margin: 0;
      outline: none;
      padding: 0;
      text-align: left;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
      margin-top: 12px;
      border-collapse: collapse;
      border-spacing: 0;
      font-variant-numeric: tabular-nums;
      max-width: 51.75em;
    }
  
    tbody {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      margin: 0;
      outline: none;
      padding: 0;
      text-align: left;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
      display: flex;
      flex-wrap: wrap;
    }
  
    .meta-row {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      outline: none;
      text-align: left;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
      display: flex;
      align-items: start;
      border-top: 1px solid #d3d3d9;
      padding: 8px 0 0 0;
      border-bottom: none;
      margin: 8px;
      width: 47.75%;
    }
  
    .meta-row-label {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      color: #4c4a73;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      margin: 0;
      outline: none;
      text-decoration: none;
      z-index: auto;
      align-self: start;
      flex: 1;
      font-size: 1rem;
      line-height: 1.5rem;
      padding: 0;
      text-align: left;
      vertical-align: top;
      text-transform: none;
      letter-spacing: 0;
    }
  
    .meta-row-value {
      text-size-adjust: 100%;
      -webkit-font-smoothing: antialiased;
      -webkit-box-direction: normal;
      color: inherit;
      font-feature-settings: "pnum";
      border-collapse: collapse;
      border-spacing: 0;
      word-break: break-word;
      box-sizing: border-box;
      background: transparent;
      border: 0;
      font: inherit;
      font-size: 100%;
      margin: 0;
      outline: none;
      padding: 0;
      text-align: right;
      text-decoration: none;
      vertical-align: baseline;
      z-index: auto;
    }
  </style>
</head>

<body class="section-projects">
  <main class="layout-stacked">
    <header class="project__header">
      <div class="layout-container">
        <a class="brand" href="https://snyk.io" title="Snyk">
          <svg width="100" height="46" fill="none" xmlns="http://www.w3.org/2000/svg">
            <title>Snyk - Snyk Code</title>
            <path d="M89.7 24.95h-.4v6.95h-5V14.6l5-7.8v16.15c.99-1.22 4.33-5.84 4.33-5.84h6.17l-5.85 6.18 6.05 8.63h-6.3l-4-6.96ZM75.77 23.8l2.05-6.67h4.94l-5.8 14.71c-1.72 4.43-4.2 7.42-7.89 7.42a7.02 7.02 0 0 1-3.24-.72l1.99-3.08c.3.04.6.05.91.05 1.7 0 2.98-1.66 3.81-3.62l-6.08-14.76h5.6l2.18 6.59c.43 1.25.74 3.64.74 3.64s.39-2.3.79-3.56Zm-15.09-.34c0-1.93-.85-2.84-2.47-2.84-.8 0-1.62.23-2.19.57v10.7h-4.99V17.28l4.89-.4-.12 2.4h.16a6.2 6.2 0 0 1 4.97-2.5c2.56 0 4.77 1.58 4.77 5.33v9.8H60.7v-8.44Zm-23.94 7.67.45-3.4c1.56.77 3.32 1.13 4.8 1.13 1.08 0 1.79-.36 1.79-1.01 0-1.87-6.73-1.42-6.73-6.3 0-3.13 2.86-4.77 6.44-4.77 1.79 0 3.64.48 4.83.9l-.48 3.35a13.22 13.22 0 0 0-4.38-.93c-.88 0-1.59.3-1.59.88 0 1.84 6.88 1.47 6.88 6.24 0 3.17-2.82 4.99-6.68 4.99-2.13 0-3.85-.37-5.33-1.08Z" fill="#fff"/>
            <g clip-path="url(#a)" fill="#fff">
              <path d="M25.86 10c.27.73.42 1.5.47 2.28v.24l-1.7 4.53c.4 3.58.77 8 .35 9.06-.2.53-.81 1.48-1.81 2.81l1.08 10.04 4.3-3.08a1.7 1.7 0 0 0 .7-1.37V12.17a1.7 1.7 0 0 0-1.22-1.63 33.9 33.9 0 0 0-2.17-.54ZM11.53 12.29a9.74 9.74 0 0 1 6.22 0l.52-.86.35-2.42s-2.43-.13-3.96-.13c-1.43 0-2.76.05-4 .14l.35 2.42.52.85ZM4.27 26.11c-.41-1.06-.04-5.48.35-9.06l-1.68-4.53v-.24c.04-.78.2-1.55.46-2.28-.9.2-1.62.39-2.18.54A1.7 1.7 0 0 0 0 12.17v22.34a1.7 1.7 0 0 0 .71 1.37l4.32 3.1L6.1 28.95c-1-1.35-1.62-2.3-1.83-2.84Z"/>
              <path d="M20.7.97a.11.11 0 0 1 .11.06l.57 1.07c1.53 2.84 4.12 8.18 4.12 10.17v.1l-1.7 4.57V17c.54 4.82.7 8.1.42 8.8-.24.62-1.2 1.94-2 3l1.18 9.57-.71.5-7.07 5.07a1.7 1.7 0 0 1-1.98 0l-5.71-4.11-.87-.63-1.16-.83 1.16-9.56a19 19 0 0 1-2.02-3.02c-.27-.7-.11-3.98.42-8.8v-.07l-1.7-4.57v-.1c0-1.99 2.59-7.33 4.12-10.17l.57-1.06a.11.11 0 0 1 .1-.07.12.12 0 0 1 .13.1l1.53 10.67.95 1.56.24-.08c1.04-.37 2.13-.57 3.24-.6 1.1.03 2.2.24 3.25.6l.24.08.93-1.56L20.6 1.07a.12.12 0 0 1 .12-.1Zm0-.97a1.08 1.08 0 0 0-1.07.94l-1.5 10.45-.45.73c-1-.3-2.02-.47-3.05-.49a11 11 0 0 0-3.04.49l-.45-.73L9.64.94A1.08 1.08 0 0 0 8.56 0a1.1 1.1 0 0 0-.97.57l-.57 1.07c-.7 1.31-4.23 8-4.23 10.64v.26l.06.17 1.62 4.36c-.56 5.16-.68 8.22-.34 9.1.08.2.32.82 1.91 2.94l-1.12 9.16-.07.57.47.34 1.16.83.87.62 5.72 4.1a2.66 2.66 0 0 0 3.1 0l7.07-5.06.7-.5.47-.34-.07-.57-1.12-9.18c1.57-2.09 1.82-2.7 1.9-2.9.34-.88.22-3.95-.34-9.1l1.62-4.37.06-.16v-.27c0-2.64-3.53-9.32-4.23-10.64L21.66.58a1.09 1.09 0 0 0-.97-.57L20.7 0Z"/>
              <path d="m7.76 27.3 2.08-.61a.22.22 0 0 0 .11-.08l1.99-2.26a.24.24 0 0 1 .37.02c.03.04.05.08.05.13l.35 6.48c0 .05-.02.1-.04.15-.14.2-.54.81-.54 1.2 0 .48.73 1.11 1.42 1.62l.03-.06c.24-.44.57-.52.72-.18.06.25.08.5.06.76h.01v.6c0 .03 0 .07-.02.1-.13.26-.75 1.37-2.08 1.37-.57 0-1.96-.18-2.58-1.88a18 18 0 0 1-.78-5.2v-.2l-.13-.15c-.33-.41-.72-.92-1.13-1.46a.24.24 0 0 1 .11-.36ZM20.52 29.11l-.12.16v.2c0 .13 0 3.08-.78 5.2a2.67 2.67 0 0 1-2.58 1.88c-1.33 0-1.94-1.1-2.08-1.37a.24.24 0 0 1-.02-.1v-.6c-.02-.26 0-.52.06-.77.14-.34.46-.26.72.18l.03.07c.7-.51 1.42-1.15 1.42-1.63 0-.38-.4-1-.54-1.2a.26.26 0 0 1-.04-.14l.35-6.48a.24.24 0 0 1 .3-.23c.05.02.09.04.12.08l1.98 2.26c.03.04.07.06.12.07l2.07.6a.24.24 0 0 1 .13.39c-.4.53-.8 1.03-1.14 1.43ZM10.26 22.31a.37.37 0 0 1-.36.32.61.61 0 0 0 .95.36.6.6 0 0 0-.04-1h1.04v.03a1.37 1.37 0 1 1-2.74.02V22h1.06-.02a.37.37 0 0 1 .1.32ZM9.59 20.92a.24.24 0 0 1-.19-.09c-.3-.35-1.2-1.55.37-1.55 1.17 0 2.1.71 2.62 1.22a.24.24 0 0 1-.17.42H9.59ZM19.11 22h-.01 1.06v.05a1.37 1.37 0 1 1-2.75-.02V22h1.05a.6.6 0 0 0-.25.73.6.6 0 0 0 .49.37.6.6 0 0 0 .68-.47.37.37 0 0 1-.27-.63ZM17.04 20.92a.24.24 0 0 1-.17-.42 3.88 3.88 0 0 1 2.63-1.22c1.56 0 .66 1.2.36 1.55a.24.24 0 0 1-.19.09h-2.63Z"/>
              <path d="M17.02 37.48a2 2 0 0 1-.49-.06.24.24 0 0 0-.24.1 2 2 0 0 1-3.29 0 .24.24 0 0 0-.24-.1c-.15.03-.3.05-.46.05h-.14a.24.24 0 0 0-.26.23c0 .05 0 .09.03.13a3.1 3.1 0 0 0 5.45 0 .24.24 0 0 0-.1-.34.24.24 0 0 0-.13-.02h-.13Zm-1.72-2.72c.17.06.33.14.48.25-.15-.25-.35-.34-.48-.25Zm-1.77.22c.14-.1.3-.17.46-.22-.13-.08-.3-.01-.46.23v-.01ZM13.91 34.26c-.17.06-.35.14-.5.25.17-.25.36-.34.5-.25ZM15.92 34.54a2.26 2.26 0 0 0-.55-.28c.15-.1.37 0 .55.28Z"/>
              <path d="M13.68 37.12a.1.1 0 0 0-.06.17 1.67 1.67 0 0 0 2.03 0 .1.1 0 0 0 .03-.1.1.1 0 0 0-.1-.07h-1.9ZM5.44 11.62c.1-.97 1-3.12 1.94-5.08a.2.2 0 0 1 .37.06l.18 1.28v.06c-.1.73-.54 3.25-1.67 5.02a.2.2 0 0 1-.35-.04l-.45-1.21a.22.22 0 0 1-.02-.1ZM23.04 12.96a14.32 14.32 0 0 1-1.67-5.08l.19-1.28a.2.2 0 0 1 .36-.06c.94 1.96 1.84 4.1 1.94 5.08v.08l-.45 1.21a.2.2 0 0 1-.28.13.2.2 0 0 1-.09-.08Z"/>
            </g>
            <defs>
              <clipPath id="a">
                <path fill="#fff" d="M0 0h29.27v45.23H0z"/>
              </clipPath>
            </defs>
          </svg>
        </a>
        <div class="test-meta">
          <p class="timestamp">August 28th 2024, 11:11:22 am (UTC+00:00)</p>
          <div class="filepath" title="/Users/amitsharma/sig_test/testSIG">Source: /Users/amitsharma/sig_test/testSIG</div>
        </div>
      </div>
    </header>

    <div class="layout-container">
      <div class="report-summary">
        <div class="header-wrap">
            <h1 class="project__header__title">Snyk Code Report</h1>

          <div class="meta-counts">
            <div class="meta-count">
              <span class="severity-icon severity-icon--high"></span> <span><strong>8</strong> high issues</span>
            </div>
            <div class="meta-count">
              <span class="severity-icon severity-icon--medium"></span> <span><strong>102</strong> medium issues</span>
            </div>
            <div class="meta-count">
              <span class="severity-icon severity-icon--low"></span> <span><strong>7</strong> low issues</span>
            </div>
          </div>
        </div>
        <div class="source-panel">
          <span class="source-panel__heading">Scan Coverage</span>
          <ul class="scan-coverage">
            <li class="type">JavaScript files: <strong>404</strong></li><li class="type">HTML files: <strong>14</strong></li><li class="type">Python files: <strong>2</strong></li><li class="type">XML files: <strong>12</strong></li><li class="type">Java files: <strong>28</strong></li>
          </ul>            
        </div>
      </div>
        <div class="cards--vuln filter--patch filter--ignore">
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the document location flows into a &#x27;src&#x27; script element attribute, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>spotfire/pvreports_template.html (line : 99)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> spotfire/pvreports_template.html</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">90:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                results &#x3D; regex.exec(location.<br /></span><span class="marker">search)</span><span class="dataflow__codesuffix">;</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">90:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                results &#x3D; regex.exec(location.<br /></span><span class="marker">search)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">90:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                results &#x3D; regex.<br /></span><span class="marker">exec(</span><span class="dataflow__codesuffix">location.search);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">90:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">results </span><span class="dataflow__codesuffix">&#x3D; regex.exec(location.search);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">results </span><span class="dataflow__codesuffix">&#x3D;&#x3D;&#x3D; null ? &quot;&quot; : decodeURIComponent(results[1].replace(/\+/g, &quot; &quot;));</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return results &#x3D;&#x3D;&#x3D; null ? &quot;&quot; : decodeURIComponent(<br /></span><span class="marker">results[</span><span class="dataflow__codesuffix">1].replace(/\+/g, &quot; &quot;));</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return results &#x3D;&#x3D;&#x3D; null ? &quot;&quot; : decodeURIComponent(<br /></span><span class="marker">results[1].</span><span class="dataflow__codesuffix">replace(/\+/g, &quot; &quot;));</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return results &#x3D;&#x3D;&#x3D; null ? &quot;&quot; : decodeURIComponent(results[1].<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">/\+/g, &quot; &quot;));</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return results &#x3D;&#x3D;&#x3D; null ? &quot;&quot; : <br /></span><span class="marker">decodeURIComponent(</span><span class="dataflow__codesuffix">results[1].replace(/\+/g, &quot; &quot;));</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">36:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">spotfire_server </span><span class="dataflow__codesuffix">&#x3D; getParameterByName(&quot;sr&quot;)</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">47:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var url &#x3D; composeSpotfireLibUrl(<br /></span><span class="marker">spotfire_server,</span><span class="dataflow__codesuffix"> path, version)</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">110:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function composeSpotfireLibUrl(<br /></span><span class="marker">spotfire_server,</span><span class="dataflow__codesuffix"> path, version) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">111:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return &quot;http://&quot; + <br /></span><span class="marker">spotfire_server </span><span class="dataflow__codesuffix">+ &quot;/&quot; + path + &quot;/GetJavaScriptApi.ashx?Version&#x3D;&quot; + version</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">47:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">url </span><span class="dataflow__codesuffix">&#x3D; composeSpotfireLibUrl(spotfire_server, path, version)</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">48:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        loadScript(<br /></span><span class="marker">url,</span><span class="dataflow__codesuffix"> function() {</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">94:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function loadScript(<br /></span><span class="marker">url,</span><span class="dataflow__codesuffix"> callback) {</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">99:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        script.src &#x3D; <br /></span><span class="marker">url;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">16</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">Path Traversal</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-23</li>
                      <li class="card__meta__item">PT</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into os.remove, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to remove arbitrary files.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 69)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;executable_config_id&quot;]</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data_source&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;data_source&quot;]</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;ml_config&quot;]</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config &#x3D; data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">580:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;] &#x3D; data[&quot;subgrp_columns&quot;] </span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">581:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if len(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;])&#x3D;&#x3D;0:</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:135</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {exec_code} , data_source :{data_source} , score_type :{table_name} ,config : {<br /></span><span class="marker">config}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[&quot;TMP_DIR&quot;] </span><span class="dataflow__codesuffix">, f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db_data_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">&quot;db&quot;)</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">587:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        os.makedirs(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exist_ok&#x3D;False)</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">590:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        meta_info &#x3D;db.create_read_meta_file(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code)</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def create_read_meta_file(self, <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code):</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">606:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        subgrp_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,&quot;subgrp_dir&quot;)</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">610:106</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        chunk_subgrp_dir &#x3D; extract_obj.subgrp_partition_multiprocessing(subgrp_dir ,db_data_dir, config ,<br /></span><span class="marker">main_data_dir)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">165:80</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def subgrp_partition_multiprocessing(self, subgrp_dir ,db_data_dir,config ,<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix"> ):</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">611:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        merge_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">f&quot;merge_dir_{exec_code}&quot; ,&quot;ith_joined&quot;)</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">614:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        filepath_to_upload &#x3D; merge_obj.process_score_dir_for_db_upload(merge_dir , <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">, exec_code , config)</span></div>
                          
                          <span class="dataflow__step">24</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">307:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def process_score_dir_for_db_upload(self ,score_dir, <br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">exec_code ,config):</span></div>
                          
                          <span class="dataflow__step">25</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">619:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        delete_util(config , [<br /></span><span class="marker">main_data_dir]</span><span class="dataflow__codesuffix"> , msg&#x3D;&quot;Deleting all alert data files&quot;)</span></div>
                          
                          <span class="dataflow__step">26</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">619:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        delete_util(config , <br /></span><span class="marker">[main_data_dir] </span><span class="dataflow__codesuffix">, msg&#x3D;&quot;Deleting all alert data files&quot;)</span></div>
                          
                          <span class="dataflow__step">27</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">66:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            for <br /></span><span class="marker">_path </span><span class="dataflow__codesuffix">in paths:</span></div>
                          
                          <span class="dataflow__step">28</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">67:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if <br /></span><span class="marker">_path </span><span class="dataflow__codesuffix">!&#x3D; &quot;&quot; and os.path.exists(_path):</span></div>
                          
                          <span class="dataflow__step">29</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">67:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if _path !&#x3D; &quot;&quot; and os.path.exists(<br /></span><span class="marker">_path)</span><span class="dataflow__codesuffix">:</span></div>
                          
                          <span class="dataflow__step">30</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">68:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if os.path.isfile(<br /></span><span class="marker">_path)</span><span class="dataflow__codesuffix">:</span></div>
                          
                          <span class="dataflow__step">31</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">69:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        os.remove(<br /></span><span class="marker">_path)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">32</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">69:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">os.remove(</span><span class="dataflow__codesuffix">_path)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">33</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A Directory Traversal attack (also known as path traversal) aims to access files and directories that are stored outside the intended folder. By manipulating files with &quot;dot-dot-slash (../)&quot; sequences and its variations, or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system, including application source code, configuration, and other critical system files.</p>
          <p>Being able to access and manipulate an arbitrary path leads to vulnerabilities when a program is being run with privileges that the user providing the path should not have. A website with a path traversal vulnerability would allow users access to sensitive files on the server hosting it. CLI programs may also be vulnerable to path traversal if they are being ran with elevated privileges (such as with the setuid or setgid flags in Unix systems).</p>
          <p>Directory Traversal vulnerabilities can be generally divided into two types:</p>
          <ul>
          <li><strong>Information Disclosure</strong>: Allows the attacker to gain information about the folder structure or read the contents of sensitive files on the system.</li>
          </ul>
          <p><code>st</code> is a module for serving static files on web pages, and contains a <a href="https://snyk.io/vuln/npm:st:20140206">vulnerability of this type</a>. In our example, we will serve files from the <code>public</code> route.</p>
          <p>If an attacker requests the following URL from our server, it will in turn leak the sensitive private key of the root user.</p>
          <pre><code>curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa
          </code></pre>
          <p><strong>Note</strong> <code>%2e</code> is the URL encoded version of <code>.</code> (dot).</p>
          <ul>
          <li><strong>Writing arbitrary files</strong>: Allows the attacker to create or replace existing files. This type of vulnerability is also known as <code>Zip-Slip</code>.</li>
          </ul>
          <p>One way to achieve this is by using a malicious <code>zip</code> archive that holds path traversal filenames. When each filename in the zip archive gets concatenated to the target extraction folder, without validation, the final path ends up outside of the target folder. If an executable or a configuration file is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue quite easily.</p>
          <p>The following is an example of a <code>zip</code> archive with one benign file and one malicious file. Extracting the malicious file will result in traversing out of the target folder, ending up in <code>/root/.ssh/</code> overwriting the <code>authorized_keys</code> file:</p>
          <pre><code>2018-04-15 22:04:29 .....           19           19  good.txt
          2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys
          </code></pre>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">Path Traversal</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-23</li>
                      <li class="card__meta__item">PT</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into shutil.rmtree, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to remove arbitrary files.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 71)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;executable_config_id&quot;]</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data_source&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;data_source&quot;]</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;ml_config&quot;]</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config &#x3D; data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">580:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;] &#x3D; data[&quot;subgrp_columns&quot;] </span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">581:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if len(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;])&#x3D;&#x3D;0:</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:135</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {exec_code} , data_source :{data_source} , score_type :{table_name} ,config : {<br /></span><span class="marker">config}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[&quot;TMP_DIR&quot;] </span><span class="dataflow__codesuffix">, f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db_data_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">&quot;db&quot;)</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">587:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        os.makedirs(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exist_ok&#x3D;False)</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">590:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        meta_info &#x3D;db.create_read_meta_file(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code)</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def create_read_meta_file(self, <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code):</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">606:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        subgrp_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,&quot;subgrp_dir&quot;)</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">610:106</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        chunk_subgrp_dir &#x3D; extract_obj.subgrp_partition_multiprocessing(subgrp_dir ,db_data_dir, config ,<br /></span><span class="marker">main_data_dir)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">165:80</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def subgrp_partition_multiprocessing(self, subgrp_dir ,db_data_dir,config ,<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix"> ):</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">611:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        merge_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">f&quot;merge_dir_{exec_code}&quot; ,&quot;ith_joined&quot;)</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">614:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        filepath_to_upload &#x3D; merge_obj.process_score_dir_for_db_upload(merge_dir , <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">, exec_code , config)</span></div>
                          
                          <span class="dataflow__step">24</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">307:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def process_score_dir_for_db_upload(self ,score_dir, <br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">exec_code ,config):</span></div>
                          
                          <span class="dataflow__step">25</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">619:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        delete_util(config , [<br /></span><span class="marker">main_data_dir]</span><span class="dataflow__codesuffix"> , msg&#x3D;&quot;Deleting all alert data files&quot;)</span></div>
                          
                          <span class="dataflow__step">26</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">619:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        delete_util(config , <br /></span><span class="marker">[main_data_dir] </span><span class="dataflow__codesuffix">, msg&#x3D;&quot;Deleting all alert data files&quot;)</span></div>
                          
                          <span class="dataflow__step">27</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">66:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            for <br /></span><span class="marker">_path </span><span class="dataflow__codesuffix">in paths:</span></div>
                          
                          <span class="dataflow__step">28</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">67:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if <br /></span><span class="marker">_path </span><span class="dataflow__codesuffix">!&#x3D; &quot;&quot; and os.path.exists(_path):</span></div>
                          
                          <span class="dataflow__step">29</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">67:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if _path !&#x3D; &quot;&quot; and os.path.exists(<br /></span><span class="marker">_path)</span><span class="dataflow__codesuffix">:</span></div>
                          
                          <span class="dataflow__step">30</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">68:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if os.path.isfile(<br /></span><span class="marker">_path)</span><span class="dataflow__codesuffix">:</span></div>
                          
                          <span class="dataflow__step">31</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        shutil.rmtree(<br /></span><span class="marker">_path)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">32</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">shutil.rmtree(</span><span class="dataflow__codesuffix">_path)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">33</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A Directory Traversal attack (also known as path traversal) aims to access files and directories that are stored outside the intended folder. By manipulating files with &quot;dot-dot-slash (../)&quot; sequences and its variations, or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system, including application source code, configuration, and other critical system files.</p>
          <p>Being able to access and manipulate an arbitrary path leads to vulnerabilities when a program is being run with privileges that the user providing the path should not have. A website with a path traversal vulnerability would allow users access to sensitive files on the server hosting it. CLI programs may also be vulnerable to path traversal if they are being ran with elevated privileges (such as with the setuid or setgid flags in Unix systems).</p>
          <p>Directory Traversal vulnerabilities can be generally divided into two types:</p>
          <ul>
          <li><strong>Information Disclosure</strong>: Allows the attacker to gain information about the folder structure or read the contents of sensitive files on the system.</li>
          </ul>
          <p><code>st</code> is a module for serving static files on web pages, and contains a <a href="https://snyk.io/vuln/npm:st:20140206">vulnerability of this type</a>. In our example, we will serve files from the <code>public</code> route.</p>
          <p>If an attacker requests the following URL from our server, it will in turn leak the sensitive private key of the root user.</p>
          <pre><code>curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa
          </code></pre>
          <p><strong>Note</strong> <code>%2e</code> is the URL encoded version of <code>.</code> (dot).</p>
          <ul>
          <li><strong>Writing arbitrary files</strong>: Allows the attacker to create or replace existing files. This type of vulnerability is also known as <code>Zip-Slip</code>.</li>
          </ul>
          <p>One way to achieve this is by using a malicious <code>zip</code> archive that holds path traversal filenames. When each filename in the zip archive gets concatenated to the target extraction folder, without validation, the final path ends up outside of the target folder. If an executable or a configuration file is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue quite easily.</p>
          <p>The following is an example of a <code>zip</code> archive with one benign file and one malicious file. Extracting the malicious file will result in traversing out of the target folder, ending up in <code>/root/.ssh/</code> overwriting the <code>authorized_keys</code> file:</p>
          <pre><code>2018-04-15 22:04:29 .....           19           19  good.txt
          2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys
          </code></pre>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">Path Traversal</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-23</li>
                      <li class="card__meta__item">PT</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into open, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to read arbitrary files.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 224)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;executable_config_id&quot;]</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data_source&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;data_source&quot;]</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;ml_config&quot;]</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config &#x3D; data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">580:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;] &#x3D; data[&quot;subgrp_columns&quot;] </span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">581:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if len(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;])&#x3D;&#x3D;0:</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:135</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {exec_code} , data_source :{data_source} , score_type :{table_name} ,config : {<br /></span><span class="marker">config}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[&quot;TMP_DIR&quot;] </span><span class="dataflow__codesuffix">, f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db_data_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">&quot;db&quot;)</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">587:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        os.makedirs(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exist_ok&#x3D;False)</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">590:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        meta_info &#x3D;db.create_read_meta_file(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code)</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def create_read_meta_file(self, <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code):</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">606:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        subgrp_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,&quot;subgrp_dir&quot;)</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">610:106</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        chunk_subgrp_dir &#x3D; extract_obj.subgrp_partition_multiprocessing(subgrp_dir ,db_data_dir, config ,<br /></span><span class="marker">main_data_dir)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">165:80</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def subgrp_partition_multiprocessing(self, subgrp_dir ,db_data_dir,config ,<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix"> ):</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">611:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        merge_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">f&quot;merge_dir_{exec_code}&quot; ,&quot;ith_joined&quot;)</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">614:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        filepath_to_upload &#x3D; merge_obj.process_score_dir_for_db_upload(merge_dir , <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">, exec_code , config)</span></div>
                          
                          <span class="dataflow__step">24</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">307:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def process_score_dir_for_db_upload(self ,score_dir, <br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">exec_code ,config):</span></div>
                          
                          <span class="dataflow__step">25</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">312:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            all_score_file_merge_csv_path &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">26</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">312:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            all_score_file_merge_csv_path &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">main_data_dir,</span></div>
                          
                          <span class="dataflow__step">27</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">223:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                for <br /></span><span class="marker">csv_path </span><span class="dataflow__codesuffix">in csvpaths_to_merge:</span></div>
                          
                          <span class="dataflow__step">28</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">224:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    with open(<br /></span><span class="marker">csv_path,</span><span class="dataflow__codesuffix"> &#x27;r&#x27;) as _f:</span></div>
                          
                          <span class="dataflow__step">29</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">224:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    with <br /></span><span class="marker">open(</span><span class="dataflow__codesuffix">csv_path, &#x27;r&#x27;) as _f:</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">30</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A Directory Traversal attack (also known as path traversal) aims to access files and directories that are stored outside the intended folder. By manipulating files with &quot;dot-dot-slash (../)&quot; sequences and its variations, or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system, including application source code, configuration, and other critical system files.</p>
          <p>Being able to access and manipulate an arbitrary path leads to vulnerabilities when a program is being run with privileges that the user providing the path should not have. A website with a path traversal vulnerability would allow users access to sensitive files on the server hosting it. CLI programs may also be vulnerable to path traversal if they are being ran with elevated privileges (such as with the setuid or setgid flags in Unix systems).</p>
          <p>Directory Traversal vulnerabilities can be generally divided into two types:</p>
          <ul>
          <li><strong>Information Disclosure</strong>: Allows the attacker to gain information about the folder structure or read the contents of sensitive files on the system.</li>
          </ul>
          <p><code>st</code> is a module for serving static files on web pages, and contains a <a href="https://snyk.io/vuln/npm:st:20140206">vulnerability of this type</a>. In our example, we will serve files from the <code>public</code> route.</p>
          <p>If an attacker requests the following URL from our server, it will in turn leak the sensitive private key of the root user.</p>
          <pre><code>curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa
          </code></pre>
          <p><strong>Note</strong> <code>%2e</code> is the URL encoded version of <code>.</code> (dot).</p>
          <ul>
          <li><strong>Writing arbitrary files</strong>: Allows the attacker to create or replace existing files. This type of vulnerability is also known as <code>Zip-Slip</code>.</li>
          </ul>
          <p>One way to achieve this is by using a malicious <code>zip</code> archive that holds path traversal filenames. When each filename in the zip archive gets concatenated to the target extraction folder, without validation, the final path ends up outside of the target folder. If an executable or a configuration file is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue quite easily.</p>
          <p>The following is an example of a <code>zip</code> archive with one benign file and one malicious file. Extracting the malicious file will result in traversing out of the target folder, ending up in <code>/root/.ssh/</code> overwriting the <code>authorized_keys</code> file:</p>
          <pre><code>2018-04-15 22:04:29 .....           19           19  good.txt
          2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys
          </code></pre>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">Path Traversal</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-23</li>
                      <li class="card__meta__item">PT</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into open, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to write arbitrary files.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 358)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;executable_config_id&quot;]</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data_source&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;data_source&quot;]</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;ml_config&quot;]</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config &#x3D; data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">580:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;] &#x3D; data[&quot;subgrp_columns&quot;] </span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">581:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if len(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;])&#x3D;&#x3D;0:</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:135</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {exec_code} , data_source :{data_source} , score_type :{table_name} ,config : {<br /></span><span class="marker">config}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[&quot;TMP_DIR&quot;] </span><span class="dataflow__codesuffix">, f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db_data_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">&quot;db&quot;)</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">587:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        os.makedirs(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exist_ok&#x3D;False)</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">590:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        meta_info &#x3D;db.create_read_meta_file(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code)</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def create_read_meta_file(self, <br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">,exec_code):</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">355:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            meta_filepath &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir </span><span class="dataflow__codesuffix">, f&quot;meta_{exec_code}.json&quot;)</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">355:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            meta_filepath &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">main_data_dir , f&quot;meta_{exec_code}.json&quot;)</span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">355:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">meta_filepath &#x3D; os.path.join(main_data_dir , f&quot;meta_{exec_code}.json&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">358:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            with open(<br /></span><span class="marker">meta_filepath </span><span class="dataflow__codesuffix">, &#x27;w&#x27;) as f:</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">358:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            with <br /></span><span class="marker">open(</span><span class="dataflow__codesuffix">meta_filepath , &#x27;w&#x27;) as f:</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">24</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A Directory Traversal attack (also known as path traversal) aims to access files and directories that are stored outside the intended folder. By manipulating files with &quot;dot-dot-slash (../)&quot; sequences and its variations, or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system, including application source code, configuration, and other critical system files.</p>
          <p>Being able to access and manipulate an arbitrary path leads to vulnerabilities when a program is being run with privileges that the user providing the path should not have. A website with a path traversal vulnerability would allow users access to sensitive files on the server hosting it. CLI programs may also be vulnerable to path traversal if they are being ran with elevated privileges (such as with the setuid or setgid flags in Unix systems).</p>
          <p>Directory Traversal vulnerabilities can be generally divided into two types:</p>
          <ul>
          <li><strong>Information Disclosure</strong>: Allows the attacker to gain information about the folder structure or read the contents of sensitive files on the system.</li>
          </ul>
          <p><code>st</code> is a module for serving static files on web pages, and contains a <a href="https://snyk.io/vuln/npm:st:20140206">vulnerability of this type</a>. In our example, we will serve files from the <code>public</code> route.</p>
          <p>If an attacker requests the following URL from our server, it will in turn leak the sensitive private key of the root user.</p>
          <pre><code>curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa
          </code></pre>
          <p><strong>Note</strong> <code>%2e</code> is the URL encoded version of <code>.</code> (dot).</p>
          <ul>
          <li><strong>Writing arbitrary files</strong>: Allows the attacker to create or replace existing files. This type of vulnerability is also known as <code>Zip-Slip</code>.</li>
          </ul>
          <p>One way to achieve this is by using a malicious <code>zip</code> archive that holds path traversal filenames. When each filename in the zip archive gets concatenated to the target extraction folder, without validation, the final path ends up outside of the target folder. If an executable or a configuration file is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue quite easily.</p>
          <p>The following is an example of a <code>zip</code> archive with one benign file and one malicious file. Extracting the malicious file will result in traversing out of the target folder, ending up in <code>/root/.ssh/</code> overwriting the <code>authorized_keys</code> file:</p>
          <pre><code>2018-04-15 22:04:29 .....           19           19  good.txt
          2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys
          </code></pre>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">Path Traversal</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-23</li>
                      <li class="card__meta__item">PT</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into shutil.copytree, where it is used as a path. This may result in a Path Traversal vulnerability and allow an attacker to read arbitrary files.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 602)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;executable_config_id&quot;]</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data_source&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;data_source&quot;]</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;ml_config&quot;]</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        config &#x3D; <br /></span><span class="marker">data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config &#x3D; data[&quot;ml_config&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">580:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;] &#x3D; data[&quot;subgrp_columns&quot;] </span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">581:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if len(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;SUBGRP_COLUMNS&quot;])&#x3D;&#x3D;0:</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:135</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {exec_code} , data_source :{data_source} , score_type :{table_name} ,config : {<br /></span><span class="marker">config}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[</span><span class="dataflow__codesuffix">&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(<br /></span><span class="marker">config[&quot;TMP_DIR&quot;] </span><span class="dataflow__codesuffix">, f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{exec_code}&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db_data_dir &#x3D; os.path.join(<br /></span><span class="marker">main_data_dir,</span><span class="dataflow__codesuffix">&quot;db&quot;)</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db_data_dir &#x3D; <br /></span><span class="marker">os.path.join(</span><span class="dataflow__codesuffix">main_data_dir,&quot;db&quot;)</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">586:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">db_data_dir &#x3D; os.path.join(main_data_dir,&quot;db&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">592:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db.read_table(exec_code , table_name , <br /></span><span class="marker">db_data_dir </span><span class="dataflow__codesuffix">,config ,meta_info)</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">372:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def read_table(self ,exec_code , table_name , <br /></span><span class="marker">db_data_dir </span><span class="dataflow__codesuffix">,config ,meta_info):</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">595:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        is_empty &#x3D;is_db_empty(<br /></span><span class="marker">db_data_dir)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">547:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">def is_db_empty(<br /></span><span class="marker">db_data_dir)</span><span class="dataflow__codesuffix">:</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            shutil.copytree(<br /></span><span class="marker">db_data_dir </span><span class="dataflow__codesuffix">,des_dir)</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">shutil.copytree(</span><span class="dataflow__codesuffix">db_data_dir ,des_dir)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">24</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A Directory Traversal attack (also known as path traversal) aims to access files and directories that are stored outside the intended folder. By manipulating files with &quot;dot-dot-slash (../)&quot; sequences and its variations, or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system, including application source code, configuration, and other critical system files.</p>
          <p>Being able to access and manipulate an arbitrary path leads to vulnerabilities when a program is being run with privileges that the user providing the path should not have. A website with a path traversal vulnerability would allow users access to sensitive files on the server hosting it. CLI programs may also be vulnerable to path traversal if they are being ran with elevated privileges (such as with the setuid or setgid flags in Unix systems).</p>
          <p>Directory Traversal vulnerabilities can be generally divided into two types:</p>
          <ul>
          <li><strong>Information Disclosure</strong>: Allows the attacker to gain information about the folder structure or read the contents of sensitive files on the system.</li>
          </ul>
          <p><code>st</code> is a module for serving static files on web pages, and contains a <a href="https://snyk.io/vuln/npm:st:20140206">vulnerability of this type</a>. In our example, we will serve files from the <code>public</code> route.</p>
          <p>If an attacker requests the following URL from our server, it will in turn leak the sensitive private key of the root user.</p>
          <pre><code>curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa
          </code></pre>
          <p><strong>Note</strong> <code>%2e</code> is the URL encoded version of <code>.</code> (dot).</p>
          <ul>
          <li><strong>Writing arbitrary files</strong>: Allows the attacker to create or replace existing files. This type of vulnerability is also known as <code>Zip-Slip</code>.</li>
          </ul>
          <p>One way to achieve this is by using a malicious <code>zip</code> archive that holds path traversal filenames. When each filename in the zip archive gets concatenated to the target extraction folder, without validation, the final path ends up outside of the target folder. If an executable or a configuration file is overwritten with a file containing malicious code, the problem can turn into an arbitrary code execution issue quite easily.</p>
          <p>The following is an example of a <code>zip</code> archive with one benign file and one malicious file. Extracting the malicious file will result in traversing out of the target folder, ending up in <code>/root/.ssh/</code> overwriting the <code>authorized_keys</code> file:</p>
          <pre><code>2018-04-15 22:04:29 .....           19           19  good.txt
          2018-04-15 22:04:42 .....           20           20  ../../../../../../root/.ssh/authorized_keys
          </code></pre>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">SQL Injection</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-89</li>
                      <li class="card__meta__item">Sqli</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into pandas.read_sql_query, where it is used in an SQL query. This may result in an SQL Injection vulnerability.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 353)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> ror_prr/ror_prr.py</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;executable_config_id&quot;]</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        exec_code&#x3D;<br /></span><span class="marker">data[&quot;executable_config_id&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">574:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">exec_code&#x3D;data[&quot;executable_config_id&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {<br /></span><span class="marker">exec_code}</span><span class="dataflow__codesuffix"> , data_source :{data_source} , score_type :{table_name} ,config : {config}&quot;)</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:79</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{table_name}_{<br /></span><span class="marker">exec_code}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">590:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        meta_info &#x3D;db.create_read_meta_file(main_data_dir ,<br /></span><span class="marker">exec_code)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def create_read_meta_file(self, main_data_dir ,<br /></span><span class="marker">exec_code)</span><span class="dataflow__codesuffix">:</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">351:77</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            query &#x3D; f&quot;select * from PVS_PRR_ROR_ML_INFO where execution_id&#x3D;{<br /></span><span class="marker">exec_code}</span><span class="dataflow__codesuffix">&quot;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">351:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            query &#x3D; <br /></span><span class="marker">f&quot;select * from PVS_PRR_ROR_ML_INFO where execution_id&#x3D;{exec_code}&quot;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">351:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">query &#x3D; f&quot;select * from PVS_PRR_ROR_ML_INFO where execution_id&#x3D;{exec_code}&quot;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">353:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            df_meta &#x3D; pd.read_sql_query(<br /></span><span class="marker">query </span><span class="dataflow__codesuffix">, en_con)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">353:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            df_meta &#x3D; <br /></span><span class="marker">pd.read_sql_query(</span><span class="dataflow__codesuffix">query , en_con)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">15</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>In an SQL injection attack, the user can submit an SQL query directly to the database, gaining access without providing appropriate credentials. Attackers can then view, export, modify, and delete confidential information; change passwords and other authentication information; and possibly gain access to other systems within the network. This is one of the most commonly exploited categories of vulnerability, but can largely be avoided through good coding practices.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid passing user-entered parameters directly to the SQL server.</li>
          <li>Avoid using string concatenation to build SQL queries from user-entered parameters.</li>
          <li>When coding, define SQL code first, then pass in parameters. Use prepared statements with parameterized queries. Examples include <code>SqlCommand()</code> in .NET and <code>bindParam()</code> in PHP.</li>
          <li>Use strong typing for all parameters so unexpected user data will be rejected.</li>
          <li>Where direct user input cannot be avoided for performance reasons, validate input against a very strict allowlist of permitted characters, avoiding special characters such as <code>? &amp; / &lt; &gt; ; - &#39; &quot; \</code> and spaces. Use a vendor-supplied escaping routine if possible.</li>
          <li>Develop your application in an environment and/or using libraries that provide protection against SQL injection.</li>
          <li>Harden your entire environment around a least-privilege model, ideally with isolated accounts with privileges only for particular tasks.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--high" data-snyk-test="high">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--high"></div>
                      <h2 class="card__title">SQL Injection</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-89</li>
                      <li class="card__meta__item">Sqli</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--high">
                      <p>Unsanitized input from the HTTP request body flows into pandas.read_sql_query, where it is used in an SQL query. This may result in an SQL Injection vulnerability.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 390)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        data&#x3D; <br /></span><span class="marker">request.get_json(</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">572:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">data&#x3D; request.get_json()</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">&quot;score_type&quot;]</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table_name &#x3D; <br /></span><span class="marker">data[&quot;score_type&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">573:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">table_name &#x3D; data[&quot;score_type&quot;]</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:112</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.info(f&quot;Request received for exec_code : {exec_code} , data_source :{data_source} , score_type :{<br /></span><span class="marker">table_name}</span><span class="dataflow__codesuffix"> ,config : {config}&quot;)</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:66</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        main_data_dir &#x3D; os.path.join(config[&quot;TMP_DIR&quot;] , f&quot;main_{<br /></span><span class="marker">table_name}</span><span class="dataflow__codesuffix">_{exec_code}&quot;)</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">592:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        db.read_table(exec_code , <br /></span><span class="marker">table_name </span><span class="dataflow__codesuffix">, db_data_dir ,config ,meta_info)</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">372:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    def read_table(self ,exec_code , <br /></span><span class="marker">table_name </span><span class="dataflow__codesuffix">, db_data_dir ,config ,meta_info):</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:65</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            logger.info(f&quot;Run Query to read data from DB table {<br /></span><span class="marker">table_name}</span><span class="dataflow__codesuffix">&quot;)</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">389:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                query &#x3D; f&quot;select * from {<br /></span><span class="marker">table_name}</span><span class="dataflow__codesuffix">_FULL_DATA_{exec_code} where PEC_RANK between {start} and {end}&quot;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">389:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                query &#x3D; <br /></span><span class="marker">f&quot;select * from {table_name}_FULL_DATA_{exec_code} where PEC_RANK between {start} and {end}&quot;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">389:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">query &#x3D; f&quot;select * from {table_name}_FULL_DATA_{exec_code} where PEC_RANK between {start} and {end}&quot;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">390:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                df &#x3D; pd.read_sql_query(<br /></span><span class="marker">query,</span><span class="dataflow__codesuffix"> en_con)</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">390:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                df &#x3D; <br /></span><span class="marker">pd.read_sql_query(</span><span class="dataflow__codesuffix">query, en_con)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">15</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>In an SQL injection attack, the user can submit an SQL query directly to the database, gaining access without providing appropriate credentials. Attackers can then view, export, modify, and delete confidential information; change passwords and other authentication information; and possibly gain access to other systems within the network. This is one of the most commonly exploited categories of vulnerability, but can largely be avoided through good coding practices.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid passing user-entered parameters directly to the SQL server.</li>
          <li>Avoid using string concatenation to build SQL queries from user-entered parameters.</li>
          <li>When coding, define SQL code first, then pass in parameters. Use prepared statements with parameterized queries. Examples include <code>SqlCommand()</code> in .NET and <code>bindParam()</code> in PHP.</li>
          <li>Use strong typing for all parameters so unexpected user data will be rejected.</li>
          <li>Where direct user input cannot be avoided for performance reasons, validate input against a very strict allowlist of permitted characters, avoiding special characters such as <code>? &amp; / &lt; &gt; ; - &#39; &quot; \</code> and spaces. Use a vendor-supplied escaping routine if possible.</li>
          <li>Develop your application in an environment and/or using libraries that provide protection against SQL injection.</li>
          <li>Harden your entire environment around a least-privilege model, ideally with isolated accounts with privileges only for particular tasks.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/alert_review.js (line : 1951)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/alert_review.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1942:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1942:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1943:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var isDisabled &#x3D; (<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">isFilterUpdateAllowed &#x3D;&#x3D; true) ? false : true</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1945:71</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #name&#x27;).val(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">name).attr(&quot;disabled&quot;, isDisabled);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1946:71</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #name&#x27;).val(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">name);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1947:78</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #description&#x27;).val(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">description);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1948:76</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #queryJSON&#x27;).val(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">JSONQuery);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1951:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #shareAdvFilterId&#x27;).html(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">shareWithElement);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1951:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #shareAdvFilterId&#x27;).html(<br /></span><span class="marker">result.shareWithElement)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1951:79</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#createAdvancedFilterModal #shareAdvFilterId&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">result.shareWithElement);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">9</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/calendar.js (line : 281)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/calendar.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">190:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    }).success(function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">190:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    }).success(function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">192:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        fillModalDataWithText(<br /></span><span class="marker">data,</span><span class="dataflow__codesuffix">mmModal,false,&#x27;meeting-minutes&#x27;);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">260:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">var fillModalDataWithText &#x3D;  function(<br /></span><span class="marker">data,</span><span class="dataflow__codesuffix">modal,isEditSeries,text){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">261:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var meetingAttendees &#x3D; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">attendees;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">275:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    for (var i &#x3D; 0; i &lt; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">meetingAttachments.length; i++) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">277:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var link &#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">meetingAttachments[i].id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">277:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var link &#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + <br /></span><span class="marker">data.meetingAttachments[</span><span class="dataflow__codesuffix">i].id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">277:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var link &#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + <br /></span><span class="marker">data.meetingAttachments[i].</span><span class="dataflow__codesuffix">id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">277:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">link </span><span class="dataflow__codesuffix">&#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + data.meetingAttachments[i].id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">278:82</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        span &#x3D; span + &quot;&lt;div class&#x3D;&#x27;attachment-name&#x27;&gt;&lt;a target&#x3D;&#x27;_blank&#x27; href&#x3D;&#x27;&quot; + <br /></span><span class="marker">link </span><span class="dataflow__codesuffix">+ &quot;&#x27; download&#x3D;&#x27;&quot; + data.meetingAttachments[i].name +</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">281:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    modal.find(&quot;.attachments .attachment-body&quot;).html(<br /></span><span class="marker">span)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">281:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    modal.find(&quot;.attachments .attachment-body&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">span)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/comments/commentTemplate.js (line : 333)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/comments/commentTemplate.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">318:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">318:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">319:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">333:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $alert.find(&#x27;.message&#x27;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">333:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $alert.find(&#x27;.message&#x27;).html(<br /></span><span class="marker">data.message)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">333:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $alert.find(&#x27;.message&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">data.message);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/apiControlPanel.js (line : 124)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/apiControlPanel.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">92:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                setTimeout(changeEtlStatus(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">, 100 );</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">103:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var changeEtlStatus &#x3D; function(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">105:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlStatus &#x3D;&#x3D; &#x27;FAILED&#x27;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">120:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(isApiControlPanelETLButtonClicked &#x3D;&#x3D; true &amp;&amp; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlStatus !&#x3D; &#x27;RUNNING&#x27;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">124:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#lastEtlDate&quot;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlDate);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">124:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#lastEtlDate&quot;).html(<br /></span><span class="marker">data.lastEtlDate)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">124:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#lastEtlDate&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">data.lastEtlDate);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/apiControlPanel.js (line : 126)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">92:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                setTimeout(changeEtlStatus(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">, 100 );</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">103:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var changeEtlStatus &#x3D; function(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">105:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlStatus &#x3D;&#x3D; &#x27;FAILED&#x27;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">120:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(isApiControlPanelETLButtonClicked &#x3D;&#x3D; true &amp;&amp; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlStatus !&#x3D; &#x27;RUNNING&#x27;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">124:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#lastEtlDate&quot;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlDate);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlBatchIds.length &lt;&#x3D; 90) {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">126:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlBatchIds);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">126:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).html(<br /></span><span class="marker">data.lastEtlBatchIds)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">126:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">data.lastEtlBatchIds);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/apiControlPanel.js (line : 128)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">91:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">92:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                setTimeout(changeEtlStatus(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">, 100 );</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">103:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var changeEtlStatus &#x3D; function(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">105:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlStatus &#x3D;&#x3D; &#x27;FAILED&#x27;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">120:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(isApiControlPanelETLButtonClicked &#x3D;&#x3D; true &amp;&amp; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlStatus !&#x3D; &#x27;RUNNING&#x27;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">124:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#lastEtlDate&quot;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlDate);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlBatchIds.length &lt;&#x3D; 90) {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">128:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">lastEtlBatchIds.substring(0,90)+&#x27;...&#x27;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">128:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).html(<br /></span><span class="marker">data.lastEtlBatchIds.</span><span class="dataflow__codesuffix">substring(0,90)+&#x27;...&#x27;);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">128:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).html(data.lastEtlBatchIds.<br /></span><span class="marker">substring(</span><span class="dataflow__codesuffix">0,90)+&#x27;...&#x27;);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">128:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).html(<br /></span><span class="marker">data.lastEtlBatchIds.substring(0,90)+&#x27;...&#x27;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">128:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#lastEtlBatchIds&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">data.lastEtlBatchIds.substring(0,90)+&#x27;...&#x27;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/apiControlPanel.js (line : 376)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">370:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">370:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">371:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">message){</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">375:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:73</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#dispositionEndPointContainer&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:73</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#dispositionEndPointContainer&#x27;).html(<br /></span><span class="marker">response.data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#dispositionEndPointContainer&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/apiControlPanel.js (line : 410)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">408:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">408:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">409:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status){</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">410:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dispositionEndPointContainer&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">410:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dispositionEndPointContainer&#x27;).html(<br /></span><span class="marker">response.data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">410:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dispositionEndPointContainer&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/apiControlPanel.js (line : 440)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">438:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">438:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">439:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status){</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">440:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&#x27;#dispositionEndPointContainer&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">440:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&#x27;#dispositionEndPointContainer&#x27;).html(<br /></span><span class="marker">response.data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">440:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&#x27;#dispositionEndPointContainer&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actions.js (line : 119)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/actions/actions.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">99:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">99:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">119:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        current_create_bt.parentsUntil(&quot;td&quot;).find(&#x27;.default-value&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">actionCount);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">119:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        current_create_bt.parentsUntil(&quot;td&quot;).find(&#x27;.default-value&#x27;).html(<br /></span><span class="marker">response.actionCount)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">119:85</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        current_create_bt.parentsUntil(&quot;td&quot;).find(&#x27;.default-value&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.actionCount);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actions.js (line : 434)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">549:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    }).done(function(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">549:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    }).done(function(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">552:65</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            setEditModalValues(editActionModal, <br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">404:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var setEditModalValues &#x3D; function (editActionModal, <br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">405:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var actionType &#x3D; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">typeObj.id;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">406:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var meetingId &#x3D; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">meetingId;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">407:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var option &#x3D; new Option(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">assignedToObj.fullName, data.assignedToUser, true, true);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">407:62</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var option &#x3D; new Option(data.assignedToObj.fullName, <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">assignedToUser, true, true);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">416:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#config&quot;).val(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">configObj.id).trigger(&#x27;change&#x27;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">417:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#actionId&quot;).val(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">id);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">418:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var dueDate &#x3D; moment(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">dueDate, DEFAULT_DATE_FORMAT).format(DEFAULT_DATE_FORMAT);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">428:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#comments&quot;).val(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">comments);</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">429:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#details&quot;).val(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">details);</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">430:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#actionStatus&quot;).val(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">actionStatus);</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">432:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#prodName&quot;).text(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">productName);</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">433:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#eventName&quot;).text(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">eventName);</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">434:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#createdBy&quot;).html(&quot;&lt;br/&gt;&lt;span&gt;Created by &quot;+<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">owner.fullName+&quot; on &quot;+data.createdDate+&quot;&lt;/span&gt;&quot;);</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">434:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#createdBy&quot;).html(&quot;&lt;br/&gt;&lt;span&gt;Created by &quot;+<br /></span><span class="marker">data.owner.</span><span class="dataflow__codesuffix">fullName+&quot; on &quot;+data.createdDate+&quot;&lt;/span&gt;&quot;);</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">434:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#createdBy&quot;).html(<br /></span><span class="marker">&quot;&lt;br/&gt;&lt;span&gt;Created by &quot;+data.owner.fullName+&quot; on &quot;+data.createdDate+&quot;&lt;/span&gt;&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">434:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        editActionModal.find(&quot;#createdBy&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">&quot;&lt;br/&gt;&lt;span&gt;Created by &quot;+data.owner.fullName+&quot; on &quot;+data.createdDate+&quot;&lt;/span&gt;&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">19</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actionList.js (line : 302)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/actions/actionList.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">302:98</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                current_create_bt.parentsUntil(&quot;td&quot;).find(&#x27;.default-value&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">actionCount);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">302:98</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                current_create_bt.parentsUntil(&quot;td&quot;).find(&#x27;.default-value&#x27;).html(<br /></span><span class="marker">response.actionCount)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">302:93</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                current_create_bt.parentsUntil(&quot;td&quot;).find(&#x27;.default-value&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.actionCount);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2149)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2142:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2142:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2143:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (!JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.success) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2149:79</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2149:73</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(JSON.<br /></span><span class="marker">parse(</span><span class="dataflow__codesuffix">data).message);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2149:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(<br /></span><span class="marker">JSON.parse(</span><span class="dataflow__codesuffix">data).message);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2149:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(<br /></span><span class="marker">JSON.parse(data).message)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2149:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">JSON.parse(data).message);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal_charts.js (line : 151)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal_charts.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">110:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">110:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">111:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">112:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var result &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data;</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">112:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var <br /></span><span class="marker">result </span><span class="dataflow__codesuffix">&#x3D; response.data;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;#assessmentDetails .rxmain-container-content&quot;).html(<br /></span><span class="marker">result[</span><span class="dataflow__codesuffix">&#x27;assessmentDetailView&#x27;]);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:84</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;#assessmentDetails .rxmain-container-content&quot;).html(<br /></span><span class="marker">result[&#x27;assessmentDetailView&#x27;])</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:79</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;#assessmentDetails .rxmain-container-content&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">result[&#x27;assessmentDetailView&#x27;]);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal_charts.js (line : 396)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">346:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">347:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">348:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var result &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data;</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">348:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var <br /></span><span class="marker">result </span><span class="dataflow__codesuffix">&#x3D; response.data;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">396:92</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    $(&quot;#assessmentDetails .rxmain-container-content&quot;).html(<br /></span><span class="marker">result[</span><span class="dataflow__codesuffix">&#x27;assessmentDetailView&#x27;]);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">396:92</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    $(&quot;#assessmentDetails .rxmain-container-content&quot;).html(<br /></span><span class="marker">result[&#x27;assessmentDetailView&#x27;])</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">396:87</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    $(&quot;#assessmentDetails .rxmain-container-content&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">result[&#x27;assessmentDetailView&#x27;]);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/priority/priority-change.js (line : 201)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/priority/priority-change.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">157:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:62</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:87</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">201:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">201:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">201:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.data.dueIn + &quot; Days&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">201:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data.dueIn + &quot; Days&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">11</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/priority/priority-change.js (line : 202)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">157:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:62</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:87</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">201:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">202:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">202:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">202:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.data.dueIn + &quot; Days&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">202:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data.dueIn + &quot; Days&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/priority/priority-change.js (line : 380)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">157:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; response.data.dueIn !&#x3D; null)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:62</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data.dueIn !&#x3D; &quot;null&quot; &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">175:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            updateDueIn(updatedRowIndexes, <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">175:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            updateDueIn(updatedRowIndexes, <br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">367:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">var updateDueIn &#x3D; function (updatedRowIndexes, <br /></span><span class="marker">updatedDueIn)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">375:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if(<br /></span><span class="marker">updatedDueIn!</span><span class="dataflow__codesuffix">&#x3D; null &amp;&amp; updatedDueIn.length &gt;0) {</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">375:43</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if(updatedDueIn!&#x3D; null &amp;&amp; <br /></span><span class="marker">updatedDueIn.</span><span class="dataflow__codesuffix">length &gt;0) {</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    days &#x3D; <br /></span><span class="marker">updatedDueIn.</span><span class="dataflow__codesuffix">filter(function (row) {</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    days &#x3D; updatedDueIn.<br /></span><span class="marker">filter(</span><span class="dataflow__codesuffix">function (row) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    days &#x3D; <br /></span><span class="marker">updatedDueIn.filter(</span><span class="dataflow__codesuffix">function (row) {</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">376:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    days &#x3D; <br /></span><span class="marker block">updatedDueIn.filter(function (row) {
                                  return row.id &#x3D;&#x3D; alertId;
                              })[0].</span><span class="dataflow__codesuffix">dueIn;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">380:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(selector).html(signal.list_utils.due_in_comp(<br /></span><span class="marker">days)</span><span class="dataflow__codesuffix">);</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">380:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(selector).html(signal.list_utils.<br /></span><span class="marker">due_in_comp(</span><span class="dataflow__codesuffix">days));</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">380:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(selector).html(<br /></span><span class="marker">signal.list_utils.due_in_comp(</span><span class="dataflow__codesuffix">days));</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">380:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(selector).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">signal.list_utils.due_in_comp(days));</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">17</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 584)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">558:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">558:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">570:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (response.data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">584:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">584:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">584:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.data.dueIn + &quot; Days&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">584:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueIn&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data.dueIn + &quot; Days&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">9</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 585)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">558:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">558:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">570:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (response.data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">584:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.data.dueIn + &quot; Days&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">585:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        $(&#x27;#dueInHeader&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data.dueIn + &quot; Days&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 988)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">962:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">962:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">974:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:83</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">988:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">988:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">988:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.data.dueIn + &quot; Days&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">988:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data.dueIn + &quot; Days&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">9</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 989)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">962:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">962:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">974:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:83</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">988:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">989:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">989:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">989:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.data.dueIn + &quot; Days&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">989:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data.dueIn + &quot; Days&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1296)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1293:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1294:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const dueInStr &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn?(response.data.dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const dueInStr &#x3D; response.data.dueIn?(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const dueInStr &#x3D; response.data.dueIn?(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const <br /></span><span class="marker">dueInStr </span><span class="dataflow__codesuffix">&#x3D; response.data.dueIn?(response.data.dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1296:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">dueInStr)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1296:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#dueIn&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">dueInStr);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">9</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1297)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1293:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1294:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const dueInStr &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn?(response.data.dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const dueInStr &#x3D; response.data.dueIn?(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const dueInStr &#x3D; response.data.dueIn?(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1295:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        const <br /></span><span class="marker">dueInStr </span><span class="dataflow__codesuffix">&#x3D; response.data.dueIn?(response.data.dueIn + &quot; Days&quot;): &quot;-&quot;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1296:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#dueIn&#x27;).html(<br /></span><span class="marker">dueInStr)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1297:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">dueInStr)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1297:43</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#dueInHeader&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">dueInStr)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1343)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1293:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1294:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionParent &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionParent &#x3D; <br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">targetDisposition;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var <br /></span><span class="marker">selectedDispositionParent </span><span class="dataflow__codesuffix">&#x3D; response.data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1315:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (typeof reviewCompletedDispostionList !&#x3D; &quot;undefined&quot; &amp;&amp; $.inArray(<br /></span><span class="marker">selectedDispositionParent,</span><span class="dataflow__codesuffix"> reviewCompletedDispostionList) &gt; -1) {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1341:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if(typeof <br /></span><span class="marker">selectedDispositionParent </span><span class="dataflow__codesuffix">!&#x3D;&#x3D;&quot;undefined&quot;){</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1342:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var escapedDispositionParent &#x3D; <br /></span><span class="marker">selectedDispositionParent.</span><span class="dataflow__codesuffix">replace(/[!&quot;#$%&amp;&#x27;()*+,.\/:;&lt;&#x3D;&gt;?@[\\\]^&#x60;{|}~]/g, &quot;\\$&amp;&quot;);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1342:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var escapedDispositionParent &#x3D; selectedDispositionParent.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">/[!&quot;#$%&amp;&#x27;()*+,.\/:;&lt;&#x3D;&gt;?@[\\\]^&#x60;{|}~]/g, &quot;\\$&amp;&quot;);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1342:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var <br /></span><span class="marker">escapedDispositionParent </span><span class="dataflow__codesuffix">&#x3D; selectedDispositionParent.replace(/[!&quot;#$%&amp;&#x27;()*+,.\/:;&lt;&#x3D;&gt;?@[\\\]^&#x60;{|}~]/g, &quot;\\$&amp;&quot;);</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1343:113</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).html($(&#x60;[title&#x3D;&quot;${<br /></span><span class="marker">escapedDispositionParent}</span><span class="dataflow__codesuffix">&quot;]&#x60;));</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1343:100</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).html(<br /></span><span class="marker">$(</span><span class="dataflow__codesuffix">&#x60;[title&#x3D;&quot;${escapedDispositionParent}&quot;]&#x60;));</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1343:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">$(&#x60;[title&#x3D;&quot;${escapedDispositionParent}&quot;]&#x60;));</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">14</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1345)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1293:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1294:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionParent &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionParent &#x3D; <br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">targetDisposition;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var <br /></span><span class="marker">selectedDispositionParent </span><span class="dataflow__codesuffix">&#x3D; response.data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1315:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (typeof reviewCompletedDispostionList !&#x3D; &quot;undefined&quot; &amp;&amp; $.inArray(<br /></span><span class="marker">selectedDispositionParent,</span><span class="dataflow__codesuffix"> reviewCompletedDispostionList) &gt; -1) {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1341:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if(typeof <br /></span><span class="marker">selectedDispositionParent </span><span class="dataflow__codesuffix">!&#x3D;&#x3D;&quot;undefined&quot;){</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1345:102</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).html($(<br /></span><span class="marker">selectedDispositionParent)</span><span class="dataflow__codesuffix">.attr(&#x27;title&#x27;));</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1345:100</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).html(<br /></span><span class="marker">$(</span><span class="dataflow__codesuffix">selectedDispositionParent).attr(&#x27;title&#x27;));</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1345:129</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).html($(selectedDispositionParent).<br /></span><span class="marker">attr(</span><span class="dataflow__codesuffix">&#x27;title&#x27;));</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1345:100</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).html(<br /></span><span class="marker">$(selectedDispositionParent).attr(</span><span class="dataflow__codesuffix">&#x27;title&#x27;));</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1345:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(currentDispositionParent).siblings(&#x27;td.currentDisposition&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">$(selectedDispositionParent).attr(&#x27;title&#x27;));</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">13</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1807)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1805:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1805:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1806:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status){</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1807:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&#x27;#signalHistory&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1807:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&#x27;#signalHistory&#x27;).html(<br /></span><span class="marker">response.data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1807:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&#x27;#signalHistory&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/actionManagement.js (line : 102)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/validated_signal/actionManagement.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">101:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">102:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#signalHistory&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">102:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#signalHistory&#x27;).html(<br /></span><span class="marker">response.data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">102:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#signalHistory&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.data);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/actionManagement.js (line : 108)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">101:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">102:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#signalHistory&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">104:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">value&#x3D;&#x3D; null||response.value &#x3D;&#x3D; &#x27;null&#x27;){</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">104:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if(response.value&#x3D;&#x3D; null||<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">value &#x3D;&#x3D; &#x27;null&#x27;){</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">108:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">value + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">108:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">response.value + &quot; Days&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">108:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&#x27;#dueInHeader&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.value + &quot; Days&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/calendar.js (line : 160)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/calendar.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">146:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">146:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">147:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">154:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    for (var index &#x3D; 0; index &lt; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.length; index++) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">155:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        var errorMessageObj &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data[index];</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">155:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        var errorMessageObj &#x3D; <br /></span><span class="marker">response.data[</span><span class="dataflow__codesuffix">index];</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">155:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        var <br /></span><span class="marker">errorMessageObj </span><span class="dataflow__codesuffix">&#x3D; response.data[index];</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">156:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        errorMsg +&#x3D; <br /></span><span class="marker">errorMessageObj;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">156:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; errorMessageObj;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">157:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/br&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">159:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &quot;&lt;/div&gt;&quot;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">160:65</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&#x27;#action-edit-modal .modal-body&#x27;).prepend(<br /></span><span class="marker">errorMsg)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">160:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&#x27;#action-edit-modal .modal-body&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">errorMsg)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/businessConfiguration/businessConfigurationListing.js (line : 397)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/businessConfiguration/businessConfigurationListing.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            }).success(function (<br /></span><span class="marker">payload)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            }).success(function (<br /></span><span class="marker">payload)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">253:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">payload.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">263:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showErrorMsg(<br /></span><span class="marker">payload.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">394:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function showErrorMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">396:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var alertHtml &#x3D; getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">372:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">377:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">373:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; +</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">379:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">396:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getErrorMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">397:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">397:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/businessConfiguration/businessConfigurationListing.js (line : 404)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            }).success(function (<br /></span><span class="marker">payload)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            }).success(function (<br /></span><span class="marker">payload)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">253:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">payload.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">261:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showSuccessMsg(<br /></span><span class="marker">payload.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">401:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function showSuccessMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">403:43</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var alertHtml &#x3D; getSuccessMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">383:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function getSuccessMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">388:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">384:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-success alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; +</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">390:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">403:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getSuccessMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">404:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">404:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/comments/commentTemplate.js (line : 412)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/comments/commentTemplate.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">61:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">61:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">62:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">66:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            showErrorMsg(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">409:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function showErrorMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">411:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var alertHtml &#x3D; getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">388:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">394:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">389:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">396:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">411:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getErrorMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">412:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">412:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/comments/commentTemplate.js (line : 422)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">318:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">318:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">319:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">329:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showSuccessMsg(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">419:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function showSuccessMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">421:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var alertHtml &#x3D; getSuccessMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">399:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function getSuccessMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">404:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">400:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-success alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; +</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">406:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">421:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getSuccessMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">422:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">422:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actions.js (line : 113)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/actions/actions.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">99:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">99:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">107:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        for (var index &#x3D; 0; index &lt; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.length; index++) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">108:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var errorMessageObj &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data[index];</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">108:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var errorMessageObj &#x3D; <br /></span><span class="marker">response.data[</span><span class="dataflow__codesuffix">index];</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">108:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var <br /></span><span class="marker">errorMessageObj </span><span class="dataflow__codesuffix">&#x3D; response.data[index];</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">109:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            errorMsg +&#x3D; <br /></span><span class="marker">errorMessageObj;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">109:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; errorMessageObj;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">110:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/br&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">112:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &quot;&lt;/div&gt;&quot;;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">113:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#createActionModal .modal-body&#x27;).prepend(<br /></span><span class="marker">errorMsg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">113:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#createActionModal .modal-body&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">errorMsg);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actions.js (line : 504)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">490:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function(<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">490:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function(<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">491:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">498:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        for(var index &#x3D; 0; index &lt; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.length; index++) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">499:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var errorMessageObj &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data[index];</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">499:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var errorMessageObj &#x3D; <br /></span><span class="marker">response.data[</span><span class="dataflow__codesuffix">index];</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">499:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var <br /></span><span class="marker">errorMessageObj </span><span class="dataflow__codesuffix">&#x3D; response.data[index];</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">500:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            errorMsg +&#x3D; <br /></span><span class="marker">errorMessageObj;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">500:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; errorMessageObj;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">501:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/br&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">503:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &quot;&lt;/div&gt;&quot;;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">504:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#action-edit-modal .modal-body&#x27;).prepend(<br /></span><span class="marker">errorMsg)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">504:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#action-edit-modal .modal-body&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">errorMsg)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actions.js (line : 583)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">569:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">569:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">570:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">577:72</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            for(var index &#x3D; 0; index &lt; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.length; index++) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">578:71</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                var errorMessageObj &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data[index];</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">578:71</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                var errorMessageObj &#x3D; <br /></span><span class="marker">response.data[</span><span class="dataflow__codesuffix">index];</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">578:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                var <br /></span><span class="marker">errorMessageObj </span><span class="dataflow__codesuffix">&#x3D; response.data[index];</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                errorMsg +&#x3D; <br /></span><span class="marker">errorMessageObj;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; errorMessageObj;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">580:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/br&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">582:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &quot;&lt;/div&gt;&quot;;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:87</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            $(&#x27;#editActionModal .modal-body&#x27;).prepend(<br /></span><span class="marker">errorMsg)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:79</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            $(&#x27;#editActionModal .modal-body&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">errorMsg)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actionList.js (line : 297)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/actions/actionList.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        }).success(function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">291:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                for (var index &#x3D; 0; index &lt; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.length; index++) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">292:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    var errorMessageObj &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data[index];</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">292:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    var errorMessageObj &#x3D; <br /></span><span class="marker">response.data[</span><span class="dataflow__codesuffix">index];</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">292:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    var <br /></span><span class="marker">errorMessageObj </span><span class="dataflow__codesuffix">&#x3D; response.data[index];</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">293:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    errorMsg +&#x3D; <br /></span><span class="marker">errorMessageObj;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">293:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; errorMessageObj;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">294:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/br&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">296:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &quot;&lt;/div&gt;&quot;;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">297:77</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#createActionModal .modal-body&#x27;).prepend(<br /></span><span class="marker">errorMsg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">297:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#createActionModal .modal-body&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">errorMsg);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actionList.js (line : 541)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">526:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">526:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">527:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status &#x3D;&#x3D; false) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">535:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        for (var index &#x3D; 0; index &lt; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.length; index++) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">536:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var errorMessageObj &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data[index];</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">536:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var errorMessageObj &#x3D; <br /></span><span class="marker">response.data[</span><span class="dataflow__codesuffix">index];</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">536:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            var <br /></span><span class="marker">errorMessageObj </span><span class="dataflow__codesuffix">&#x3D; response.data[index];</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">537:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            errorMsg +&#x3D; <br /></span><span class="marker">errorMessageObj;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">537:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; errorMessageObj;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">538:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/br&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">540:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">errorMsg </span><span class="dataflow__codesuffix">+&#x3D; &quot;&lt;/div&gt;&quot;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">541:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#action-edit-modal .modal-body&#x27;).prepend(<br /></span><span class="marker">errorMsg)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">541:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&#x27;#action-edit-modal .modal-body&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">errorMsg)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2178)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2142:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2142:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2143:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (!JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.success) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2164:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showSuccessNotification(JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2164:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showSuccessNotification(JSON.<br /></span><span class="marker">parse(</span><span class="dataflow__codesuffix">data).message);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2164:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showSuccessNotification(<br /></span><span class="marker">JSON.parse(</span><span class="dataflow__codesuffix">data).message);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2175:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function showSuccessNotification(<br /></span><span class="marker">message)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2177:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">message </span><span class="dataflow__codesuffix">!&#x3D; undefined &amp;&amp; message !&#x3D; &quot;&quot;)</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2177:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (message !&#x3D; undefined &amp;&amp; <br /></span><span class="marker">message </span><span class="dataflow__codesuffix">!&#x3D; &quot;&quot;)</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2184:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                encodeToHTML(<br /></span><span class="marker">message)</span><span class="dataflow__codesuffix"> +</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2184:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">encodeToHTML(</span><span class="dataflow__codesuffix">message) +</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2179:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker block">&#x27;&lt;div class&#x3D;&quot;alert alert-success alert-dismissable&quot;&gt;&#x27; +
                          &#x27;&lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;close&quot; &#x27; +
                          &#x27;data-dismiss&#x3D;&quot;alert&quot; aria-hidden&#x3D;&quot;true&quot;&gt;&#x27; +
                          &#x27;&amp;times;&#x27; +
                          &#x27;&lt;/button&gt;&#x27; +
                          encodeToHTML(message) +
                          &#x27;&lt;/div&gt;&#x27;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2178:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;#detailsTab&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 614)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">558:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">558:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">570:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">583:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    if (response.data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">597:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.signal !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">598:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            var valSignal&#x3D;<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.signal</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">598:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            var valSignal&#x3D;<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">signal</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">598:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            var <br /></span><span class="marker">valSignal&#x3D;</span><span class="dataflow__codesuffix">response.data.signal</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">599:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            var sanitizedSignalName &#x3D; DOMPurify.sanitize(<br /></span><span class="marker">valSignal.</span><span class="dataflow__codesuffix">name)</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">601:111</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                addNewSignal &#x3D; &#x27; &lt;li signalName&#x3D;&quot;&#x27;+(sanitizedSignalName)+&#x27; &#x27;+(<br /></span><span class="marker">valSignal.</span><span class="dataflow__codesuffix">products)+&#x27;&quot;&gt;&#x27; +</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">614:71</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            $(&#x27;#signal-list&#x27;).prepend(<br /></span><span class="marker">addNewSignal)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">614:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            $(&#x27;#signal-list&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">addNewSignal)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">13</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1018)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">962:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">962:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">974:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; null &amp;&amp; response.data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">987:83</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (response.data!&#x3D;null &amp;&amp; response.data.dueIn !&#x3D; null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn !&#x3D; &quot;null&quot;) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1001:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.signal !&#x3D; null) {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1002:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var valSignal&#x3D;<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.signal</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1002:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var valSignal&#x3D;<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">signal</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1002:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var <br /></span><span class="marker">valSignal&#x3D;</span><span class="dataflow__codesuffix">response.data.signal</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1003:78</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                var sanitizedSignalName &#x3D; DOMPurify.sanitize(<br /></span><span class="marker">valSignal.</span><span class="dataflow__codesuffix">name)</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1005:99</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    addNewSignal &#x3D; &#x27; &lt;li signalName&#x3D;&quot;&#x27;+(sanitizedSignalName)+&#x27; &#x27;+(<br /></span><span class="marker">valSignal.</span><span class="dataflow__codesuffix">products)+&#x27;&quot;&gt;&#x27; +</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1018:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#signal-list&#x27;).prepend(<br /></span><span class="marker">addNewSignal)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1018:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                $(&#x27;#signal-list&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">addNewSignal)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">13</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actionTemplate.js (line : 282)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/actions/actionTemplate.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">69:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">69:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">70:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">74:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            showErrorMsg(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">279:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function showErrorMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">281:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var alertHtml &#x3D; getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">259:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">264:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">260:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; +</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">266:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">281:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getErrorMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">282:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">282:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actionTemplate.js (line : 289)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">211:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">211:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">212:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">215:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    showSuccessMsg(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">286:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function showSuccessMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">288:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var alertHtml &#x3D; getSuccessMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">269:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function getSuccessMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">274:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">270:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-success alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; +</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">276:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">288:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getSuccessMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">289:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">289:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/evdas_alert_details.js (line : 290)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/evdas_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">612:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    ecaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;ecaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">612:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    ecaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;ecaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">685:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">ecaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">515:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">696:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">698:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">452:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">471:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        new $.fn.dataTable.FixedColumns(<br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">699:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix">d.advancedFilterId &#x3D; advancedFilterId</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; <br /></span><span class="marker">table.</span><span class="dataflow__codesuffix">rows(index).data()[0].productName;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; table.<br /></span><span class="marker">rows(</span><span class="dataflow__codesuffix">index).data()[0].productName;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; <br /></span><span class="marker">table.rows(</span><span class="dataflow__codesuffix">index).data()[0].productName;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; table.rows(index).<br /></span><span class="marker">data(</span><span class="dataflow__codesuffix">)[0].productName;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; <br /></span><span class="marker">table.rows(index).data(</span><span class="dataflow__codesuffix">)[0].productName;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; <br /></span><span class="marker">table.rows(index).data()[0].</span><span class="dataflow__codesuffix">productName;</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">productName </span><span class="dataflow__codesuffix">&#x3D; table.rows(index).data()[0].productName;</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">290:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        evdasHistoryModal.find(&quot;#productName&quot;).html(<br /></span><span class="marker">productName)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">290:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        evdasHistoryModal.find(&quot;#productName&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">productName);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">17</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/evdas_alert_details.js (line : 291)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">612:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    ecaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;ecaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">612:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    ecaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;ecaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">685:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">ecaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">515:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">696:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">698:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">452:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">471:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        new $.fn.dataTable.FixedColumns(<br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">699:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix">d.advancedFilterId &#x3D; advancedFilterId</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">283:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var productName &#x3D; <br /></span><span class="marker">table.</span><span class="dataflow__codesuffix">rows(index).data()[0].productName;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var eventName &#x3D; <br /></span><span class="marker">table.</span><span class="dataflow__codesuffix">rows(index).data()[0].preferredTerm;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var eventName &#x3D; table.<br /></span><span class="marker">rows(</span><span class="dataflow__codesuffix">index).data()[0].preferredTerm;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var eventName &#x3D; <br /></span><span class="marker">table.rows(</span><span class="dataflow__codesuffix">index).data()[0].preferredTerm;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:43</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var eventName &#x3D; table.rows(index).<br /></span><span class="marker">data(</span><span class="dataflow__codesuffix">)[0].preferredTerm;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var eventName &#x3D; <br /></span><span class="marker">table.rows(index).data(</span><span class="dataflow__codesuffix">)[0].preferredTerm;</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var eventName &#x3D; <br /></span><span class="marker">table.rows(index).data()[0].</span><span class="dataflow__codesuffix">preferredTerm;</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">284:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">eventName </span><span class="dataflow__codesuffix">&#x3D; table.rows(index).data()[0].preferredTerm;</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">291:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        evdasHistoryModal.find(&quot;#eventName&quot;).html(<br /></span><span class="marker">eventName)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">291:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        evdasHistoryModal.find(&quot;#eventName&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">eventName);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">18</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2624)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">547:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">scaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">300:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.sca_data_table &#x3D; <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.<br /></span><span class="marker">sca_data_table </span><span class="dataflow__codesuffix">&#x3D; table;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table &#x3D; table;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">279:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage &amp;&amp; signal.alertReview.isAlertPersistedInSessionStorage(prefix)) {</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2257:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2418:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; selectedCase;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2430:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var currntUrl &#x3D; <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2482:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; reloadUrl</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var row &#x3D; <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table.row(tr);</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var row &#x3D; <br /></span><span class="marker">window.sca_data_table.</span><span class="dataflow__codesuffix">row(tr);</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var row &#x3D; window.sca_data_table.<br /></span><span class="marker">row(</span><span class="dataflow__codesuffix">tr);</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">row </span><span class="dataflow__codesuffix">&#x3D; window.sca_data_table.row(tr);</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2724:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            row.child(format(<br /></span><span class="marker">row.</span><span class="dataflow__codesuffix">data()), className).show();</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2724:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            row.child(format(row.<br /></span><span class="marker">data(</span><span class="dataflow__codesuffix">)), className).show();</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2619:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">var format &#x3D; function (<br /></span><span class="marker">d,</span><span class="dataflow__codesuffix"> className) {</span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2621:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var productList &#x3D; <br /></span><span class="marker">d.</span><span class="dataflow__codesuffix">suspProd;</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2623:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var ptArray &#x3D; <br /></span><span class="marker">d.</span><span class="dataflow__codesuffix">ptList.split(new RegExp(&#x27;!@##@!|\r\n&#x27;, &#x27;g&#x27;));</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2624:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var patMedHist &#x3D; $(&quot;&lt;p/&gt;&quot;).html(<br /></span><span class="marker">d.</span><span class="dataflow__codesuffix">patientMedHist).text();</span></div>
                          
                          <span class="dataflow__step">24</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2624:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var patMedHist &#x3D; $(&quot;&lt;p/&gt;&quot;).html(<br /></span><span class="marker">d.patientMedHist)</span><span class="dataflow__codesuffix">.text();</span></div>
                          
                          <span class="dataflow__step">25</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2624:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var patMedHist &#x3D; $(&quot;&lt;p/&gt;&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">d.patientMedHist).text();</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">26</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2682)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">547:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">scaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">300:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.sca_data_table &#x3D; <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.<br /></span><span class="marker">sca_data_table </span><span class="dataflow__codesuffix">&#x3D; table;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table &#x3D; table;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">279:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage &amp;&amp; signal.alertReview.isAlertPersistedInSessionStorage(prefix)) {</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2257:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2418:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; selectedCase;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2430:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var currntUrl &#x3D; <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2482:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; reloadUrl</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var row &#x3D; <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table.row(tr);</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var row &#x3D; <br /></span><span class="marker">window.sca_data_table.</span><span class="dataflow__codesuffix">row(tr);</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var row &#x3D; window.sca_data_table.<br /></span><span class="marker">row(</span><span class="dataflow__codesuffix">tr);</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2719:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">row </span><span class="dataflow__codesuffix">&#x3D; window.sca_data_table.row(tr);</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2722:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            row.child(detailsViewFormatJADER(<br /></span><span class="marker">row.</span><span class="dataflow__codesuffix">data()), className).show();</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2722:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            row.child(detailsViewFormatJADER(row.<br /></span><span class="marker">data(</span><span class="dataflow__codesuffix">)), className).show();</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2678:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">var detailsViewFormatJADER &#x3D; function (<br /></span><span class="marker">d,</span><span class="dataflow__codesuffix"> className) {</span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2680:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var productList &#x3D; <br /></span><span class="marker">d.</span><span class="dataflow__codesuffix">suspProd;</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2682:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var patMedHist &#x3D; $(&quot;&lt;p/&gt;&quot;).html(<br /></span><span class="marker">d.</span><span class="dataflow__codesuffix">patientMedHist).text();</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2682:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var patMedHist &#x3D; $(&quot;&lt;p/&gt;&quot;).html(<br /></span><span class="marker">d.patientMedHist)</span><span class="dataflow__codesuffix">.text();</span></div>
                          
                          <span class="dataflow__step">24</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2682:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var patMedHist &#x3D; $(&quot;&lt;p/&gt;&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">d.patientMedHist).text();</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">25</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js (line : 1389)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/disposition/disposition-change.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1289:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1293:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1294:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1313:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionParent &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1349:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionTitle &#x3D; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1349:52</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var selectedDispositionTitle &#x3D; <br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">targetDisposition;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1349:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var <br /></span><span class="marker">selectedDispositionTitle </span><span class="dataflow__codesuffix">&#x3D; response.data.targetDisposition;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1350:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    selectedDispositionTitle &#x3D; handleQuotesForJson(<br /></span><span class="marker">selectedDispositionTitle)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1350:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    selectedDispositionTitle &#x3D; <br /></span><span class="marker">handleQuotesForJson(</span><span class="dataflow__codesuffix">selectedDispositionTitle);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1352:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if(typeof <br /></span><span class="marker">selectedDispositionTitle </span><span class="dataflow__codesuffix">!&#x3D;&#x3D;&quot;undefined&quot;){</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1353:87</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        escapedSelectedDispositionTitle &#x3D; escapeSpecialCharactersInId(<br /></span><span class="marker">selectedDispositionTitle)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1353:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        escapedSelectedDispositionTitle &#x3D; <br /></span><span class="marker">escapeSpecialCharactersInId(</span><span class="dataflow__codesuffix">selectedDispositionTitle);</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1366:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">escapedSelectedDispositionTitle </span><span class="dataflow__codesuffix">&amp;&amp; $(&#x27;.disposition-ico :input[value&#x3D;&quot;&#x27; + escapedSelectedDispositionTitle + &#x27;&quot;]&#x27;).size() &lt;&#x3D; 0) {</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1366:98</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (escapedSelectedDispositionTitle &amp;&amp; $(&#x27;.disposition-ico :input[value&#x3D;&quot;&#x27; + <br /></span><span class="marker">escapedSelectedDispositionTitle </span><span class="dataflow__codesuffix">+ &#x27;&quot;]&#x27;).size() &lt;&#x3D; 0) {</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1543:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var uniqueFilter &#x3D; <br /></span><span class="marker">dynamicFilterValue.</span><span class="dataflow__codesuffix">replaceAll(&quot; &quot;,&quot;_&quot;);</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1543:43</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var uniqueFilter &#x3D; dynamicFilterValue.<br /></span><span class="marker">replaceAll(</span><span class="dataflow__codesuffix">&quot; &quot;,&quot;_&quot;);</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1543:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">uniqueFilter </span><span class="dataflow__codesuffix">&#x3D; dynamicFilterValue.replaceAll(&quot; &quot;,&quot;_&quot;);</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1545:268</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return &#x27; &lt;li data-url&#x3D;&quot;addWidgetUrl&quot; class&#x3D;&quot;checkbox checkbox-primary space-nowrap&quot; data-id&#x3D;&quot;pv-dash-searchCase&quot; data-params&#x3D;&quot;{&amp;quot;widgetType&amp;quot;: &amp;quot;SEARCH_CASE&amp;quot;}&quot; data-widgetid&#x3D;&quot;3298&quot;&gt; &lt;input type&#x3D;&quot;checkbox&quot; name&#x3D;&quot;relatedResults&quot; id&#x3D;&quot;filter_&#x27; + <br /></span><span class="marker">uniqueFilter </span><span class="dataflow__codesuffix">+ &#x27;&quot; name&#x3D;&quot;filter_&#x27; + uniqueFilter + &#x27;&quot; value&#x3D;&quot;&#x27; + escapeAllHtml(dynamicFilterValue) + &#x27;&quot; class&#x3D;&quot;dynamic-filters&quot;&gt;&lt;label class&#x3D;&quot;dispositionValue&quot; for&#x3D;&quot;filter_&#x27; + uniqueFilter + &#x27;&quot;&gt;&#x27; + dynamicFilterValue + &#x27;&lt;/label&gt;&#x27;</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1387:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        var <br /></span><span class="marker">dynamicDispositionFilter </span><span class="dataflow__codesuffix">&#x3D; fetchDynamicDispositionFilterHtml(escapedSelectedDispositionTitle, isClosed);</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1389:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;.disposition-ico&quot;).append($(<br /></span><span class="marker">dynamicDispositionFilter)</span><span class="dataflow__codesuffix">);</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1389:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;.disposition-ico&quot;).append(<br /></span><span class="marker">$(</span><span class="dataflow__codesuffix">dynamicDispositionFilter));</span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1389:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;.disposition-ico&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">$(dynamicDispositionFilter));</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">22</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/actions/actionTemplate.js (line : 242)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/actions/actionTemplate.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">189:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var editJustificationSuccessCallback &#x3D; function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">189:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var editJustificationSuccessCallback &#x3D; function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">190:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">192:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            populateFormData(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">data, actionTemplateModal);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">230:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function populateFormData(<br /></span><span class="marker">data,</span><span class="dataflow__codesuffix"> actionTemplateModal) {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">234:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        actionTemplateModal.find(&quot;#name&quot;).val(unescapeHTML(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">name));</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">235:67</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        actionTemplateModal.find(&quot;#description&quot;).val(unescapeHTML(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">description));</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">236:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var actionPropertiesObj &#x3D; JSON.parse(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">actionProperties);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">241:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">guestAttendeeEmail)</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">242:80</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            actionTemplateModal.find(&quot;#assignedTo&quot;).append(&quot;&lt;option value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">guestAttendeeEmail + &quot;&#x27; isGuest&#x3D;&#x27;true&#x27;&gt;&quot; + data.guestAttendeeEmail + &quot;&lt;/option&gt;&quot;);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">242:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            actionTemplateModal.find(&quot;#assignedTo&quot;).append(<br /></span><span class="marker">&quot;&lt;option value&#x3D;&#x27;&quot; + data.guestAttendeeEmail + &quot;&#x27; isGuest&#x3D;&#x27;true&#x27;&gt;&quot; + data.guestAttendeeEmail + &quot;&lt;/option&gt;&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">242:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            actionTemplateModal.find(&quot;#assignedTo&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;option value&#x3D;&#x27;&quot; + data.guestAttendeeEmail + &quot;&#x27; isGuest&#x3D;&#x27;true&#x27;&gt;&quot; + data.guestAttendeeEmail + &quot;&lt;/option&gt;&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">11</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 100)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">98:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">98:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">99:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">100:67</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 125)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">123:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">123:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">124:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:91</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:91</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 151)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">149:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">149:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">150:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:97</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:97</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:76</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">151:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 177)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">175:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">175:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">176:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">177:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Trade Name&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">177:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Trade Name&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">177:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Trade Name&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">177:67</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;Trade Name&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 202)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">200:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">201:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">203:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">203:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">202:66</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Trade Name&#x27;]&quot;).append(<br /></span><span class="marker block">&quot;&lt;li class&#x3D;&#x27;highlighted selected&#x27; data-value&#x3D;&#x27;&quot; +
                                  data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +
                                  data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">202:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Trade Name&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li class&#x3D;&#x27;highlighted selected&#x27; data-value&#x3D;&#x27;&quot; +</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 221)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">219:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">219:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">220:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">221:83</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">221:83</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">221:62</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">221:55</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Family&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 250)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">247:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">247:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">248:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">249:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">length &#x3D;&#x3D; 1) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">250:120</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(&quot;&lt;li class&#x3D;&#x27;highlighted selected&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">250:120</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(&quot;&lt;li class&#x3D;&#x27;highlighted selected&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">250:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li class&#x3D;&#x27;highlighted selected&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">250:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li class&#x3D;&#x27;highlighted selected&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 252)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">247:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">247:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">248:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">249:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">length &#x3D;&#x3D; 1) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:91</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:91</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:63</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;ul[dictionarylevel&#x3D;&#x27;Ingredient&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_utils.js (line : 269)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">267:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">267:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">268:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">269:89</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">269:89</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).append(&quot;&lt;li data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">269:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).append(<br /></span><span class="marker">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">269:61</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    $(&quot;ul[dictionarylevel&#x3D;&#x27;Product Name&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">&quot;&lt;li data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into innerHTML, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alertComments/alertComments.js (line : 60)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alertComments/alertComments.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">42:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">42:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">56:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    for (let element in <br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">59:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        opt.value &#x3D; <br /></span><span class="marker">response[</span><span class="dataflow__codesuffix">element].id;</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        opt.innerHTML &#x3D; <br /></span><span class="marker">response[</span><span class="dataflow__codesuffix">element].name;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        opt.innerHTML &#x3D; <br /></span><span class="marker">response[element].</span><span class="dataflow__codesuffix">name;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        opt.innerHTML &#x3D; <br /></span><span class="marker">response[element].name;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        opt.innerHTML &#x3D; <br /></span><span class="marker">response[element].name;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/advanceOption.js (line : 453)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/advanceOption.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">319:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">319:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">321:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                for (var i &#x3D; 0; i &lt; <br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">length; i++) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">323:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if ($.inArray(<br /></span><span class="marker">result[</span><span class="dataflow__codesuffix">i].display, operatorArray) &gt; -1) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">324:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        operatorDiv +&#x3D; &#x27;&lt;option value&#x3D;&quot;&#x27; + <br /></span><span class="marker">result[</span><span class="dataflow__codesuffix">i].value + &#x27;&quot;&gt;&#x27; + result[i].display + &#x27;&lt;/option&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">324:60</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        operatorDiv +&#x3D; &#x27;&lt;option value&#x3D;&quot;&#x27; + <br /></span><span class="marker">result[i].</span><span class="dataflow__codesuffix">value + &#x27;&quot;&gt;&#x27; + result[i].display + &#x27;&lt;/option&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">324:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        <br /></span><span class="marker">operatorDiv </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;option value&#x3D;&quot;&#x27; + result[i].value + &#x27;&quot;&gt;&#x27; + result[i].display + &#x27;&lt;/option&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">327:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">operatorDiv </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/select&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">330:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">operatorDiv </span><span class="dataflow__codesuffix">+&#x3D; &#x27;&lt;/div&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">453:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#dataMiningVariableString&quot;).html(<br /></span><span class="marker">operatorDiv </span><span class="dataflow__codesuffix">+ dataMiningVariableValueDiv + dataMiningVariableIcons + &#x27;&lt;/div&gt;&#x27;);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">453:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#dataMiningVariableString&quot;).html(<br /></span><span class="marker">operatorDiv + dataMiningVariableValueDiv + dataMiningVariableIcons + &#x27;&lt;/div&gt;&#x27;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">453:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&quot;#dataMiningVariableString&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">operatorDiv + dataMiningVariableValueDiv + dataMiningVariableIcons + &#x27;&lt;/div&gt;&#x27;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">11</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/configuration/copyPasteValues.js (line : 207)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/configuration/copyPasteValues.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">70:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">resp)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">70:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">resp)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                var data&#x3D;JSON.parse(<br /></span><span class="marker">resp)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                var data&#x3D;JSON.<br /></span><span class="marker">parse(</span><span class="dataflow__codesuffix">resp);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                var <br /></span><span class="marker">data&#x3D;</span><span class="dataflow__codesuffix">JSON.parse(resp);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">72:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">success) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">207:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(currentQEV).find(&quot;#importValuesTemplateContainer&quot;).html(<br /></span><span class="marker">$response.</span><span class="dataflow__codesuffix">uploadedValues);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">207:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(currentQEV).find(&quot;#importValuesTemplateContainer&quot;).html(<br /></span><span class="marker">$response.uploadedValues)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">207:70</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(currentQEV).find(&quot;#importValuesTemplateContainer&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">$response.uploadedValues);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal_create.js (line : 993)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal_create.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">990:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var saveJustificationSuccessCallback &#x3D; function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">990:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var saveJustificationSuccessCallback &#x3D; function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">991:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">992:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">value !&#x3D; &quot;null&quot; &amp;&amp; result.value !&#x3D; null){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">992:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(result.value !&#x3D; &quot;null&quot; &amp;&amp; <br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">value !&#x3D; null){</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">993:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">value + &quot; Days&quot;);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">993:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&#x27;#dueInHeader&#x27;).html(<br /></span><span class="marker">result.value + &quot; Days&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">993:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&#x27;#dueInHeader&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">result.value + &quot; Days&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/review.js (line : 946)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/validated_signal/review.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">942:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">942:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">943:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if (!JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.success) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">946:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">946:69</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(JSON.<br /></span><span class="marker">parse(</span><span class="dataflow__codesuffix">data).message);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">946:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(<br /></span><span class="marker">JSON.parse(</span><span class="dataflow__codesuffix">data).message);</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">946:64</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).html(<br /></span><span class="marker">JSON.parse(data).message)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">946:59</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                addCaseModalObj.find(&#x27;.errorMessageSpan&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">JSON.parse(data).message);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/drugClassification/drugClassification.js (line : 89)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/drugClassification/drugClassification.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">138:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">138:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">139:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                showSuccessMessage(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status, response.message);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">139:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                showSuccessMessage(response.status, <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">84:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var showSuccessMessage &#x3D; function (isSuccess, <br /></span><span class="marker">message)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">89:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        messageDiv.html(<br /></span><span class="marker">message)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">89:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        messageDiv.<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">message);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/justification/justification.js (line : 168)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/justification/justification.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">155:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var saveJustificationSuccessCallback &#x3D; function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">155:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var saveJustificationSuccessCallback &#x3D; function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">156:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message &#x3D;&#x3D;&#x3D; &quot;Justification added successfully&quot; &amp;&amp; $(&#x27;#justificationModalHeader&#x27;).html() &#x3D;&#x3D;&#x3D; &quot;Edit Justification&quot;)</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">161:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">168:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $alert.find(&#x27;.message&#x27;).html(<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">168:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $alert.find(&#x27;.message&#x27;).html(<br /></span><span class="marker">data.message)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">168:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $alert.find(&#x27;.message&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">data.message);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/configuration/dateRangeEvdas.js (line : 265)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/configuration/dateRangeEvdas.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">263:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">263:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">264:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">miningFrequency) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">265:55</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;#substanceFrequency&quot;).html(<br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">miningFrequency + &quot; Frequency&quot;);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">265:55</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;#substanceFrequency&quot;).html(<br /></span><span class="marker">result.miningFrequency + &quot; Frequency&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">265:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(&quot;#substanceFrequency&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">result.miningFrequency + &quot; Frequency&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">5</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/meeting/meeting.js (line : 183)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/meeting/meeting.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">322:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    }).success(function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">322:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    }).success(function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">324:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        fillModalDataWithText(<br /></span><span class="marker">data,</span><span class="dataflow__codesuffix">mmModal,false,&#x27;meeting-minutes&#x27;);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">162:43</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var fillModalDataWithText &#x3D;  function(<br /></span><span class="marker">data,</span><span class="dataflow__codesuffix">modal,isEditSeries,text){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">163:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var meetingAttendees &#x3D; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">attendees;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">177:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        for (var i &#x3D; 0; i &lt; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">meetingAttachments.length; i++) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">179:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var link &#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">meetingAttachments[i].id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">179:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var link &#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + <br /></span><span class="marker">data.meetingAttachments[</span><span class="dataflow__codesuffix">i].id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">179:74</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var link &#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + <br /></span><span class="marker">data.meetingAttachments[i].</span><span class="dataflow__codesuffix">id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">179:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var <br /></span><span class="marker">link </span><span class="dataflow__codesuffix">&#x3D; &quot;/signal/meeting/viewAttachments?attachmentId&#x3D;&quot; + data.meetingAttachments[i].id + &quot;&amp;meetingId&#x3D;&quot; + data.id</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:88</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            span &#x3D; span + &quot;&lt;a class&#x3D;&#x27;attachment-name m-t-15&#x27; target&#x3D;&#x27;_blank&#x27; href&#x3D;&#x27;&quot; + <br /></span><span class="marker">link </span><span class="dataflow__codesuffix">+ &quot;&#x27; download&#x3D;&#x27;&quot; + data.meetingAttachments[i].name +</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">183:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        modal.find(&quot;.attachments .attachment-body&quot;).html(<br /></span><span class="marker">span)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">183:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        modal.find(&quot;.attachments .attachment-body&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">span)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">12</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/etlStatus.js (line : 35)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/etlStatus.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">20:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">20:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">result)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">21:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var status &#x3D; <br /></span><span class="marker">result.</span><span class="dataflow__codesuffix">status</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">21:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var <br /></span><span class="marker">status </span><span class="dataflow__codesuffix">&#x3D; result.status</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">22:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            window.etlStatus &#x3D; <br /></span><span class="marker">status;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">24:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            switch (<br /></span><span class="marker">status)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">26:67</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    html &#x3D; &#x27;&lt;span class&#x3D;&quot;label label-success&quot;&gt;&#x27; + <br /></span><span class="marker">status </span><span class="dataflow__codesuffix">+ &#x27;&lt;/span&gt;&#x27;;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">35:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;.etlStatus&#x27;).html(<br /></span><span class="marker">html)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">35:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            $(&#x27;.etlStatus&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">html);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/dashboard/pvs-link-widget.js (line : 255)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/dashboard/pvs-link-widget.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">251:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">251:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var response &#x3D; JSON.parse(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var response &#x3D; JSON.<br /></span><span class="marker">parse(</span><span class="dataflow__codesuffix">data);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">252:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var <br /></span><span class="marker">response </span><span class="dataflow__codesuffix">&#x3D; JSON.parse(data);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">253:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">code &#x3D;&#x3D;&#x3D; 500){</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">255:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $alert.find(&#x27;.message&#x27;).html(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">message);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">255:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $alert.find(&#x27;.message&#x27;).html(<br /></span><span class="marker">response.message)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">255:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $alert.find(&#x27;.message&#x27;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">response.message);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into html, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/query/to_add_container.js (line : 219)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/query/to_add_container.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">172:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">resp)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">172:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                success: function (<br /></span><span class="marker">resp)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">173:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var data&#x3D;JSON.parse(<br /></span><span class="marker">resp)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">173:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var data&#x3D;JSON.<br /></span><span class="marker">parse(</span><span class="dataflow__codesuffix">resp);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">173:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    var <br /></span><span class="marker">data&#x3D;</span><span class="dataflow__codesuffix">JSON.parse(resp);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">174:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    if (<br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">success) {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">219:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&quot;#importValuesTemplateContainer&quot;).html(<br /></span><span class="marker">$response.</span><span class="dataflow__codesuffix">uploadedValues);</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">219:58</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&quot;#importValuesTemplateContainer&quot;).html(<br /></span><span class="marker">$response.uploadedValues)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">219:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                $(&quot;#importValuesTemplateContainer&quot;).<br /></span><span class="marker">html(</span><span class="dataflow__codesuffix">$response.uploadedValues);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alertAdministration/alertAdministration.js (line : 1465)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alertAdministration/alertAdministration.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1206:98</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        type: &quot;POST&quot;, url: url, data: data, dataType: &#x27;json&#x27;, success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1206:98</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        type: &quot;POST&quot;, url: url, data: data, dataType: &#x27;json&#x27;, success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1207:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1215:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">code &#x3D;&#x3D; 1) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1216:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    showErrorMsg(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">message)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1463:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function showErrorMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1464:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var alertHtml &#x3D; getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1451:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    function getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1452:299</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var alertHtml &#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; + &#x27;&lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;close&quot; data-dismiss&#x3D;&quot;alert&quot;&gt; &#x27; + &#x27;&lt;span aria-hidden&#x3D;&quot;true&quot;&gt;&amp;times;&lt;/span&gt; &#x27; + &#x27;&lt;span class&#x3D;&quot;sr-only&quot;&gt;&lt;g:message code&#x3D;&quot;default.button.close.label&quot; /&gt;&lt;/span&gt; &#x27; + &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1452:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27; + &#x27;&lt;button type&#x3D;&quot;button&quot; class&#x3D;&quot;close&quot; data-dismiss&#x3D;&quot;alert&quot;&gt; &#x27; + &#x27;&lt;span aria-hidden&#x3D;&quot;true&quot;&gt;&amp;times;&lt;/span&gt; &#x27; + &#x27;&lt;span class&#x3D;&quot;sr-only&quot;&gt;&lt;g:message code&#x3D;&quot;default.button.close.label&quot; /&gt;&lt;/span&gt; &#x27; + &#x27;&lt;/button&gt; &#x27; + msg;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1454:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1464:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getErrorMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1465:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1465:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">13</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/productTypeConfiguration.js (line : 405)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/productTypeConfiguration.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">197:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">197:56</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                    success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">198:44</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                        if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">success) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">207:48</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                            if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">209:104</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                    var message &#x3D; &#x60;Cannot delete: ${name} is used in ${<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data} scheduled alerts &lt;a href &#x3D;&quot;/signal/productTypeConfiguration/linkedAggAlerts?productConfigId&#x3D;${data.id}&quot; target&#x3D;&quot;_blank&quot;&quot; class&#x3D;&quot;linked-alert-info-icon&quot; data-instanceid&#x3D;&quot;${data.id}&quot;&gt;See Details&lt;/a&gt;&#x60;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">209:57</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                    var <br /></span><span class="marker">message </span><span class="dataflow__codesuffix">&#x3D; &#x60;Cannot delete: ${name} is used in ${response.data} scheduled alerts &lt;a href &#x3D;&quot;/signal/productTypeConfiguration/linkedAggAlerts?productConfigId&#x3D;${data.id}&quot; target&#x3D;&quot;_blank&quot;&quot; class&#x3D;&quot;linked-alert-info-icon&quot; data-instanceid&#x3D;&quot;${data.id}&quot;&gt;See Details&lt;/a&gt;&#x60;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">210:66</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                                    showErrorMsg(<br /></span><span class="marker">message)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">402:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function showErrorMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">404:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var alertHtml &#x3D; getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">381:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">387:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">382:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">389:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">404:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getErrorMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">405:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">405:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">15</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into prepend, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal.js (line : 672)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/validated_signal/validated_signal.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">605:94</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    type: &quot;POST&quot;, url: url, data: data, dataType: &#x27;json&#x27;, success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">605:94</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    type: &quot;POST&quot;, url: url, data: data, dataType: &#x27;json&#x27;, success: function (<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">607:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        if (<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">status) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">632:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">code &#x3D;&#x3D;1) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">633:46</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                showErrorMsg(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">message)</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">669:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function showErrorMsg(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">671:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var alertHtml &#x3D; getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">648:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">function getErrorMessageHtml(<br /></span><span class="marker">msg)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">654:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        &#x27;&lt;/button&gt; &#x27; + <br /></span><span class="marker">msg;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">649:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; &#x27;&lt;div class&#x3D;&quot;alert alert-danger alert-dismissible&quot; role&#x3D;&quot;alert&quot;&gt; &#x27;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">656:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    return <br /></span><span class="marker">alertHtml;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">671:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var <br /></span><span class="marker">alertHtml </span><span class="dataflow__codesuffix">&#x3D; getErrorMessageHtml(msg);</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">672:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).prepend(<br /></span><span class="marker">alertHtml)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">672:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    $(&#x27;body .messageContainer&#x27;).<br /></span><span class="marker">prepend(</span><span class="dataflow__codesuffix">alertHtml);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">13</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_product_utils.js (line : 32)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alert_utils/alert_product_utils.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">24:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">24:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">26:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">33:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">33:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">33:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                <br /></span><span class="marker block">&quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +
                                          data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">32:105</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul.productDictionaryColWidth[dictionarylevel&#x3D;&#x27;&quot; + containerLevel + &quot;&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/mart_product_utils.js (line : 24)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alert_utils/mart_product_utils.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">19:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">19:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">21:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">25:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevelMart&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">25:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevelMart&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">25:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                <br /></span><span class="marker block">&quot;&lt;li class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevelMart&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +
                                          data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">24:83</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevelMart&#x3D;&#x27;&quot; + containerLevel + &quot;&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/Disassociation/disassociate.js (line : 125)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/Disassociation/disassociate.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">121:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success:function(<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix">{</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">121:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success:function(<br /></span><span class="marker">response)</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">122:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;null &amp;&amp; response.data!&#x3D;undefined ){</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">122:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(response.data!&#x3D;null &amp;&amp; <br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data!&#x3D;undefined ){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">123:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">               if(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn!&#x3D;null){</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                   $(&quot;#dueInHeader&quot;).append(<br /></span><span class="marker">response.</span><span class="dataflow__codesuffix">data.dueIn+&quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                   $(&quot;#dueInHeader&quot;).append(<br /></span><span class="marker">response.data.</span><span class="dataflow__codesuffix">dueIn+&quot; Days&quot;)</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                   $(&quot;#dueInHeader&quot;).append(<br /></span><span class="marker">response.data.dueIn+&quot; Days&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">125:38</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                   $(&quot;#dueInHeader&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix">response.data.dueIn+&quot; Days&quot;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_event_utils.js (line : 29)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alert_utils/alert_event_utils.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">22:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">22:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">23:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        searchListData&#x3D;<br /></span><span class="marker">data</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">26:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">30:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; +</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">30:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; +</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">30:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                <br /></span><span class="marker block">&quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; +
                                          data[index].level + &quot;&#x27;&gt;&quot; + data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">29:103</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul.eventDictionaryColWidth[dictionarylevel&#x3D;&#x27;&quot; + containerLevel + &quot;&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">7</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alert_utils/alert_study_utils.js (line : 21)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alert_utils/alert_study_utils.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">16:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">16:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">18:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">22:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">22:68</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">22:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                <br /></span><span class="marker block">&quot;&lt;li class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +
                                          data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">21:79</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul[dictionarylevel&#x3D;&#x27;&quot; + containerLevel + &quot;&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Cross-site Scripting (XSS)</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79</li>
                      <li class="card__meta__item">DOMXSS</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into append, where it is used to dynamically construct the HTML page on client side. This may result in a DOM Based Cross-Site Scripting attack (DOMXSS).</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/productIngredientMapping/ingredient_mapping.js (line : 64)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/productIngredientMapping/ingredient_mapping.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">59:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">59:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">61:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        $(<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix">.each(function (index) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">65:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[</span><span class="dataflow__codesuffix">index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">65:95</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                &quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + <br /></span><span class="marker">data[index].</span><span class="dataflow__codesuffix">id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">65:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                                <br /></span><span class="marker block">&quot;&lt;li tabindex&#x3D;&#x27;0&#x27; role&#x3D;&#x27;button&#x27; class&#x3D;&#x27;dicLi&#x27; data-value&#x3D;&#x27;&quot; + data[index].id + &quot;&#x27; dictionarylevel&#x3D;&#x27;&quot; + data[index].level + &quot;&#x27;&gt;&quot; +
                                          data[index].name + &quot;&lt;/li&gt;&quot;)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">64:97</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                            $(&quot;ul.column-ingredient[dictionarylevel&#x3D;&#x27;&quot; + containerLevel + &quot;&#x27;]&quot;).<br /></span><span class="marker">append(</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.</p>
          <p>This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML)  in order to perform actions that are otherwise typically blocked by the browser&#39;s Same Origin Policy.</p>
          <p>Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.</p>
          <p>Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, <code>&lt;</code> can be coded as  <code>&amp;lt</code>; and <code>&gt;</code> can be coded as <code>&amp;gt</code>; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses <code>&lt;</code> and <code>&gt;</code> as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they&#39;ve been correctly escaped in the application code and in this way the attempted attack is diverted.</p>
          <p>The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.</p>
          <h3 id="types-of-attacks">Types of attacks</h3>
          <p>There are a few methods by which XSS can be manipulated:</p>
          <table>
          <thead>
          <tr>
          <th>Type</th>
          <th>Origin</th>
          <th>Description</th>
          </tr>
          </thead>
          <tbody><tr>
          <td><strong>Stored</strong></td>
          <td>Server</td>
          <td>The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link.</td>
          </tr>
          <tr>
          <td><strong>Reflected</strong></td>
          <td>Server</td>
          <td>The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user&#39;s browser.</td>
          </tr>
          <tr>
          <td><strong>DOM-based</strong></td>
          <td>Client</td>
          <td>The attacker forces the user&#39;s browser to render a malicious page. The data in the page itself delivers the cross-site scripting data.</td>
          </tr>
          <tr>
          <td><strong>Mutated</strong></td>
          <td></td>
          <td>The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters.</td>
          </tr>
          </tbody></table>
          <h3 id="affected-environments">Affected environments</h3>
          <p>The following environments are susceptible to an XSS attack:</p>
          <ul>
          <li>Web servers</li>
          <li>Application servers</li>
          <li>Web application environments</li>
          </ul>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <p>This section describes the top best practices designed to specifically protect your code:</p>
          <ul>
          <li>Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.</li>
          <li>Convert special characters such as <code>?</code>, <code>&amp;</code>, <code>/</code>, <code>&lt;</code>, <code>&gt;</code> and spaces to their respective HTML or URL encoded equivalents.</li>
          <li>Give users the option to disable client-side scripts.</li>
          <li>Redirect invalid requests.</li>
          <li>Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.</li>
          <li>Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.</li>
          <li>Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 116)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">116:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">116:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">116:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">sessionStorage.getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">116:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">sessionStorage.getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">3</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2384)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">547:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">scaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">300:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.sca_data_table &#x3D; <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.<br /></span><span class="marker">sca_data_table </span><span class="dataflow__codesuffix">&#x3D; table;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table &#x3D; table;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">279:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage &amp;&amp; signal.alertReview.isAlertPersistedInSessionStorage(prefix)) {</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2257:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2557:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2375:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">updatedExportUrl </span><span class="dataflow__codesuffix">+&#x3D; &quot;&amp;tempViewId&#x3D;&quot; + tempViewPresent;</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            window.location.href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            window.location.href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">17</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2567)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">547:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">scaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">300:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.sca_data_table &#x3D; <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.<br /></span><span class="marker">sca_data_table </span><span class="dataflow__codesuffix">&#x3D; table;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table &#x3D; table;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">279:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage &amp;&amp; signal.alertReview.isAlertPersistedInSessionStorage(prefix)) {</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2257:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2557:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2557:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">href </span><span class="dataflow__codesuffix">&#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2567:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">href </span><span class="dataflow__codesuffix">+&#x3D; &quot;&amp;promptUser&#x3D;&quot; + true;</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2567:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">href +&#x3D; &quot;&amp;promptUser&#x3D;&quot; + true;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2567:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">href +&#x3D; &quot;&amp;promptUser&#x3D;&quot; + true;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">18</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2571)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">415:54</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                    scaEntriesCount &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&quot;scaPageEntries&quot;);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">547:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            &quot;iTotalDisplayRecords&quot;: <br /></span><span class="marker">scaEntriesCount,</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">300:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        table &#x3D; $(&#x27;#alertsDetailsTable&#x27;).<br /></span><span class="marker">DataTable(</span><span class="dataflow__codesuffix">{</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">575:75</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        signal.user_group_utils.bind_assignTo_selection(assignToGroupUrl, <br /></span><span class="marker">table,</span><span class="dataflow__codesuffix"> hasReviewerAccess);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">576:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        init_filter(<br /></span><span class="marker">table)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">579:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    var init_filter &#x3D; function (<br /></span><span class="marker">data_table)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.sca_data_table &#x3D; <br /></span><span class="marker">table;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.<br /></span><span class="marker">sca_data_table </span><span class="dataflow__codesuffix">&#x3D; table;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">602:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sca_data_table &#x3D; table;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">279:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage &amp;&amp; signal.alertReview.isAlertPersistedInSessionStorage(prefix)) {</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2257:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        if (<br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">sessionStorage) {</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2384:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2557:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2557:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">href </span><span class="dataflow__codesuffix">&#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2571:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">href </span><span class="dataflow__codesuffix">+&#x3D; &quot;&amp;promptUser&#x3D;&quot; + false;</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2571:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">href +&#x3D; &quot;&amp;promptUser&#x3D;&quot; + false;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2571:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">href +&#x3D; &quot;&amp;promptUser&#x3D;&quot; + false;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">18</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/agg_case_alert_details.js (line : 180)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/agg_case_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">sessionStorage.getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">sessionStorage.getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">3</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/agg_case_alert_details.js (line : 4205)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.<br /></span><span class="marker">href </span><span class="dataflow__codesuffix">&#x3D; sessionStorage.getItem(&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">180:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; sessionStorage.getItem(&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">4205:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">4205:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">4205:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/agg_case_alert_adhoc_details.js (line : 80)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/agg_case_alert_adhoc_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">sessionStorage.getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">sessionStorage.getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">3</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from browser storage flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/agg_case_alert_adhoc_details.js (line : 1256)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:47</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; sessionStorage.<br /></span><span class="marker">getItem(</span><span class="dataflow__codesuffix">&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.<br /></span><span class="marker">href </span><span class="dataflow__codesuffix">&#x3D; sessionStorage.getItem(&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">80:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; sessionStorage.getItem(&#x27;back_url&#x27;)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1256:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; updatedExportUrl;</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1256:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1256:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.location.href &#x3D; <br /></span><span class="marker">updatedExportUrl;</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/alert_review.js (line : 2300)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/alert_review.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2291:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2291:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2293:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var selectedView &#x3D; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">viewId;</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2293:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var <br /></span><span class="marker">selectedView </span><span class="dataflow__codesuffix">&#x3D; data.viewId;</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2300:85</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location &#x3D; pageURL.slice(0, pageURL.indexOf(&quot;viewId&quot;) + 7) + <br /></span><span class="marker">selectedView</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2300:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location &#x3D; <br /></span><span class="marker">pageURL.slice(0, pageURL.indexOf(&quot;viewId&quot;) + 7) + selectedView</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2300:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location &#x3D; <br /></span><span class="marker">pageURL.slice(0, pageURL.indexOf(&quot;viewId&quot;) + 7) + selectedView</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">6</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from data from a remote resource flows into window.location, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/alert_review.js (line : 2429)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2291:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2291:28</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        success: function (<br /></span><span class="marker">data)</span><span class="dataflow__codesuffix"> {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2293:32</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var selectedView &#x3D; <br /></span><span class="marker">data.</span><span class="dataflow__codesuffix">viewId;</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2293:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var <br /></span><span class="marker">selectedView </span><span class="dataflow__codesuffix">&#x3D; data.viewId;</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2300:85</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location &#x3D; pageURL.slice(0, pageURL.indexOf(&quot;viewId&quot;) + 7) + <br /></span><span class="marker">selectedView</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2300:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.<br /></span><span class="marker">location </span><span class="dataflow__codesuffix">&#x3D; pageURL.slice(0, pageURL.indexOf(&quot;viewId&quot;) + 7) + selectedView</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2300:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location &#x3D; pageURL.slice(0, pageURL.indexOf(&quot;viewId&quot;) + 7) + selectedView</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2298:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location &#x3D; pageURL.slice(0, preIndex - 1) + &quot;&amp;viewId&#x3D;&quot; + selectedView</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2296:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location &#x3D; pageURL.slice(0, preIndex - 1) + pageURL.slice(pageURL.indexOf(&#x27;&amp;&#x27; , preIndex )) + &quot;&amp;viewId&#x3D;&quot; + selectedView</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2451:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; pageURL.slice(0, preIndex - 1) + pageURL.slice(pageURL.indexOf(&#x27;&amp;&#x27; , preIndex )) + &quot;&amp;viewId&#x3D;&quot; + selectedView</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2429:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">window.</span><span class="dataflow__codesuffix">location.href &#x3D; pageURL</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2429:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                <br /></span><span class="marker">window.location.</span><span class="dataflow__codesuffix">href &#x3D; pageURL</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2429:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">pageURL</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2429:40</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                window.location.href &#x3D; <br /></span><span class="marker">pageURL</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">13</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from the document location flows into replace, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/backbone/backbone.js (line : 1432)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/backbone/backbone.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.<br /></span><span class="marker">href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.<br /></span><span class="marker">href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; <br /></span><span class="marker">(window || this).location.href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.href.<br /></span><span class="marker">match(</span><span class="dataflow__codesuffix">/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:11</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var <br /></span><span class="marker">match </span><span class="dataflow__codesuffix">&#x3D; (window || this).location.href.match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1365:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return <br /></span><span class="marker">match </span><span class="dataflow__codesuffix">? match[1] : &#x27;&#x27;;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1365:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return match ? <br /></span><span class="marker">match[</span><span class="dataflow__codesuffix">1] : &#x27;&#x27;;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1380:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return <br /></span><span class="marker">fragment.</span><span class="dataflow__codesuffix">replace(routeStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1380:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return fragment.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">routeStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1432:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">          this.location.replace(<br /></span><span class="marker">this.root + &#x27;#&#x27; + this.fragment)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1432:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">          this.location.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">this.root + &#x27;#&#x27; + this.fragment);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from the document location flows into replace, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/backbone/backbone.js (line : 1538)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.<br /></span><span class="marker">href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.<br /></span><span class="marker">href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; <br /></span><span class="marker">(window || this).location.href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.href.<br /></span><span class="marker">match(</span><span class="dataflow__codesuffix">/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:11</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var <br /></span><span class="marker">match </span><span class="dataflow__codesuffix">&#x3D; (window || this).location.href.match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1365:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return <br /></span><span class="marker">match </span><span class="dataflow__codesuffix">? match[1] : &#x27;&#x27;;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1365:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return match ? <br /></span><span class="marker">match[</span><span class="dataflow__codesuffix">1] : &#x27;&#x27;;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1380:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return <br /></span><span class="marker">fragment.</span><span class="dataflow__codesuffix">replace(routeStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1380:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return fragment.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">routeStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1501:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      fragment &#x3D; <br /></span><span class="marker">fragment.</span><span class="dataflow__codesuffix">replace(pathStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1501:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      fragment &#x3D; fragment.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">pathStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1503:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      if (this.fragment &#x3D;&#x3D;&#x3D; <br /></span><span class="marker">fragment)</span><span class="dataflow__codesuffix"> return;</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1504:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      this.fragment &#x3D; <br /></span><span class="marker">fragment;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1507:11</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      if (<br /></span><span class="marker">fragment </span><span class="dataflow__codesuffix">&#x3D;&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; url !&#x3D;&#x3D; &#x27;/&#x27;) url &#x3D; url.slice(0, -1);</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1541:31</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        location.hash &#x3D; &#x27;#&#x27; + <br /></span><span class="marker">fragment;</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">14</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1541:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        location.<br /></span><span class="marker">hash </span><span class="dataflow__codesuffix">&#x3D; &#x27;#&#x27; + fragment;</span></div>
                          
                          <span class="dataflow__step">15</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1541:9</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        <br /></span><span class="marker">location.</span><span class="dataflow__codesuffix">hash &#x3D; &#x27;#&#x27; + fragment;</span></div>
                          
                          <span class="dataflow__step">16</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1528:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">this.location.</span><span class="dataflow__codesuffix">assign(url);</span></div>
                          
                          <span class="dataflow__step">17</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1535:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    _updateHash: function(<br /></span><span class="marker">location,</span><span class="dataflow__codesuffix"> fragment, replace) {</span></div>
                          
                          <span class="dataflow__step">18</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1537:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var href &#x3D; <br /></span><span class="marker">location.</span><span class="dataflow__codesuffix">href.replace(/(javascript:|#).*$/, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">19</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1537:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var href &#x3D; <br /></span><span class="marker">location.href.</span><span class="dataflow__codesuffix">replace(/(javascript:|#).*$/, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">20</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1537:34</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var href &#x3D; location.href.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">/(javascript:|#).*$/, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">21</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1537:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        var <br /></span><span class="marker">href </span><span class="dataflow__codesuffix">&#x3D; location.href.replace(/(javascript:|#).*$/, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">22</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1538:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        location.replace(<br /></span><span class="marker">href </span><span class="dataflow__codesuffix">+ &#x27;#&#x27; + fragment);</span></div>
                          
                          <span class="dataflow__step">23</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1538:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        location.replace(<br /></span><span class="marker">href + &#x27;#&#x27; + fragment)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">24</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1538:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        location.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">href + &#x27;#&#x27; + fragment);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">25</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from the document location flows into replace, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js (line : 2445)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/app/pvs/alerts_review/single_case_alert_details.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2430:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var currntUrl &#x3D; window.location.<br /></span><span class="marker">href</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2430:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var currntUrl &#x3D; window.location.<br /></span><span class="marker">href</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2430:17</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            var <br /></span><span class="marker">currntUrl </span><span class="dataflow__codesuffix">&#x3D; window.location.href</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2431:33</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(currntUrl.charAt(<br /></span><span class="marker">currntUrl.</span><span class="dataflow__codesuffix">length-1) &#x3D;&#x3D;&#x3D; &quot;#&quot;){</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2431:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            if(<br /></span><span class="marker">currntUrl.</span><span class="dataflow__codesuffix">charAt(currntUrl.length-1) &#x3D;&#x3D;&#x3D; &quot;#&quot;){</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2432:51</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                currntUrl &#x3D; currntUrl.substring(0,<br /></span><span class="marker">currntUrl.</span><span class="dataflow__codesuffix">length-2)</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2432:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                currntUrl &#x3D; <br /></span><span class="marker">currntUrl.</span><span class="dataflow__codesuffix">substring(0,currntUrl.length-2)</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2432:39</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                currntUrl &#x3D; currntUrl.<br /></span><span class="marker">substring(</span><span class="dataflow__codesuffix">0,currntUrl.length-2)</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2434:13</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            <br /></span><span class="marker">currntUrl </span><span class="dataflow__codesuffix">+&#x3D; &quot;&amp;isCaseSeriesAlert&#x3D;true&quot;;</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2445:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        window.location.replace(<br /></span><span class="marker">currntUrl)</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">2445:41</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">                        window.location.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">currntUrl)</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from the document location flows into assign, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/backbone/backbone.js (line : 1528)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/backbone/backbone.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.<br /></span><span class="marker">href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:45</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.<br /></span><span class="marker">href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:19</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; <br /></span><span class="marker">(window || this).location.href.</span><span class="dataflow__codesuffix">match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var match &#x3D; (window || this).location.href.<br /></span><span class="marker">match(</span><span class="dataflow__codesuffix">/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1364:11</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var <br /></span><span class="marker">match </span><span class="dataflow__codesuffix">&#x3D; (window || this).location.href.match(/#(.*)$/);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1365:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return <br /></span><span class="marker">match </span><span class="dataflow__codesuffix">? match[1] : &#x27;&#x27;;</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1365:22</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return match ? <br /></span><span class="marker">match[</span><span class="dataflow__codesuffix">1] : &#x27;&#x27;;</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1380:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return <br /></span><span class="marker">fragment.</span><span class="dataflow__codesuffix">replace(routeStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1380:23</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      return fragment.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix">routeStripper, &#x27;&#x27;);</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1498:11</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      var <br /></span><span class="marker">url </span><span class="dataflow__codesuffix">&#x3D; this.root + (fragment &#x3D; this.getFragment(fragment || &#x27;&#x27;));</span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1507:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      if (fragment &#x3D;&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; <br /></span><span class="marker">url </span><span class="dataflow__codesuffix">!&#x3D;&#x3D; &#x27;/&#x27;) url &#x3D; url.slice(0, -1);</span></div>
                          
                          <span class="dataflow__step">10</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1507:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      if (fragment &#x3D;&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; url !&#x3D;&#x3D; &#x27;/&#x27;) url &#x3D; <br /></span><span class="marker">url.</span><span class="dataflow__codesuffix">slice(0, -1);</span></div>
                          
                          <span class="dataflow__step">11</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1507:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      if (fragment &#x3D;&#x3D;&#x3D; &#x27;&#x27; &amp;&amp; url !&#x3D;&#x3D; &#x27;/&#x27;) url &#x3D; url.<br /></span><span class="marker">slice(</span><span class="dataflow__codesuffix">0, -1);</span></div>
                          
                          <span class="dataflow__step">12</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1528:37</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return this.location.assign(<br /></span><span class="marker">url)</span><span class="dataflow__codesuffix">;</span></div>
                          
                          <span class="dataflow__step">13</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1528:30</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return this.location.<br /></span><span class="marker">assign(</span><span class="dataflow__codesuffix">url);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">14</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Permissive Cross-domain Policy</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-942</li>
                      <li class="card__meta__item">TooPermissiveCorsPostMessage</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Setting targetOrigin to &quot;*&quot; in postMessage may enable malicious parties to intercept the message. Consider using an exact target origin instead.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents-lite.js (line : 635)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents-lite.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">635:42</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            window.postMessage(sentinel, <br /></span><span class="marker">&quot;*&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">635:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">            window.<br /></span><span class="marker">postMessage(</span><span class="dataflow__codesuffix">sentinel, &quot;*&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">1</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>As a legacy of early web design and site limitations, most web applications default, for security reasons, to a &quot;same origin policy&quot;. This means that browsers can only retrieve data from another site if the two sites share the same domain. In today&#39;s complex online environment, however, sites and applications often need to retrieve data from other domains. This is done under fairly limited conditions through an exception to the same origin policy known as &quot;cross-origin resource sharing&quot;.</p>
          <p>Developers may create definitions of trusted domains that are broader than absolutely necessary, inadvertently opening up wider access than intended. This weakness could result in data exposure or loss, or even allow an attacker to take over the site or application.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid using wildcards for cross-origin resource sharing. Instead, define intended domains explicitly.</li>
          <li>Ensure that your site or app is well defended against cross-site scripting attacks (XSS), which could lead to takeover via an overly permissive cross-domain policy.</li>
          <li>Do not mix secure and insecure protocols when defining cross-domain policies.</li>
          <li>Consider defining a clear approved list to specify which domains will be given resource-level access; use this approved list to validate all domain access requests.</li>
          <li>Clearly define which methods (view, read, and update) are permitted for each resource and domain to avoid abuse.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Permissive Cross-domain Policy</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-942</li>
                      <li class="card__meta__item">TooPermissiveCorsPostMessage</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Setting targetOrigin to &quot;*&quot; in postMessage may enable malicious parties to intercept the message. Consider using an exact target origin instead.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents.js (line : 5490)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">5490:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.postMessage(sentinel, <br /></span><span class="marker">&quot;*&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">5490:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.<br /></span><span class="marker">postMessage(</span><span class="dataflow__codesuffix">sentinel, &quot;*&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">1</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>As a legacy of early web design and site limitations, most web applications default, for security reasons, to a &quot;same origin policy&quot;. This means that browsers can only retrieve data from another site if the two sites share the same domain. In today&#39;s complex online environment, however, sites and applications often need to retrieve data from other domains. This is done under fairly limited conditions through an exception to the same origin policy known as &quot;cross-origin resource sharing&quot;.</p>
          <p>Developers may create definitions of trusted domains that are broader than absolutely necessary, inadvertently opening up wider access than intended. This weakness could result in data exposure or loss, or even allow an attacker to take over the site or application.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid using wildcards for cross-origin resource sharing. Instead, define intended domains explicitly.</li>
          <li>Ensure that your site or app is well defended against cross-site scripting attacks (XSS), which could lead to takeover via an overly permissive cross-domain policy.</li>
          <li>Do not mix secure and insecure protocols when defining cross-domain policies.</li>
          <li>Consider defining a clear approved list to specify which domains will be given resource-level access; use this approved list to validate all domain access requests.</li>
          <li>Clearly define which methods (view, read, and update) are permitted for each resource and domain to avoid abuse.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Permissive Cross-domain Policy</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-942</li>
                      <li class="card__meta__item">TooPermissiveCorsPostMessage</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Setting targetOrigin to &quot;*&quot; in postMessage may enable malicious parties to intercept the message. Consider using an exact target origin instead.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/HTMLImports.js (line : 71)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/HTMLImports.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.postMessage(sentinel, <br /></span><span class="marker">&quot;*&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.<br /></span><span class="marker">postMessage(</span><span class="dataflow__codesuffix">sentinel, &quot;*&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">1</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>As a legacy of early web design and site limitations, most web applications default, for security reasons, to a &quot;same origin policy&quot;. This means that browsers can only retrieve data from another site if the two sites share the same domain. In today&#39;s complex online environment, however, sites and applications often need to retrieve data from other domains. This is done under fairly limited conditions through an exception to the same origin policy known as &quot;cross-origin resource sharing&quot;.</p>
          <p>Developers may create definitions of trusted domains that are broader than absolutely necessary, inadvertently opening up wider access than intended. This weakness could result in data exposure or loss, or even allow an attacker to take over the site or application.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid using wildcards for cross-origin resource sharing. Instead, define intended domains explicitly.</li>
          <li>Ensure that your site or app is well defended against cross-site scripting attacks (XSS), which could lead to takeover via an overly permissive cross-domain policy.</li>
          <li>Do not mix secure and insecure protocols when defining cross-domain policies.</li>
          <li>Consider defining a clear approved list to specify which domains will be given resource-level access; use this approved list to validate all domain access requests.</li>
          <li>Clearly define which methods (view, read, and update) are permitted for each resource and domain to avoid abuse.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Permissive Cross-domain Policy</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-942</li>
                      <li class="card__meta__item">TooPermissiveCorsPostMessage</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Setting targetOrigin to &quot;*&quot; in postMessage may enable malicious parties to intercept the message. Consider using an exact target origin instead.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/MutationObserver.js (line : 71)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/MutationObserver.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.postMessage(sentinel, <br /></span><span class="marker">&quot;*&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.<br /></span><span class="marker">postMessage(</span><span class="dataflow__codesuffix">sentinel, &quot;*&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">1</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>As a legacy of early web design and site limitations, most web applications default, for security reasons, to a &quot;same origin policy&quot;. This means that browsers can only retrieve data from another site if the two sites share the same domain. In today&#39;s complex online environment, however, sites and applications often need to retrieve data from other domains. This is done under fairly limited conditions through an exception to the same origin policy known as &quot;cross-origin resource sharing&quot;.</p>
          <p>Developers may create definitions of trusted domains that are broader than absolutely necessary, inadvertently opening up wider access than intended. This weakness could result in data exposure or loss, or even allow an attacker to take over the site or application.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid using wildcards for cross-origin resource sharing. Instead, define intended domains explicitly.</li>
          <li>Ensure that your site or app is well defended against cross-site scripting attacks (XSS), which could lead to takeover via an overly permissive cross-domain policy.</li>
          <li>Do not mix secure and insecure protocols when defining cross-domain policies.</li>
          <li>Consider defining a clear approved list to specify which domains will be given resource-level access; use this approved list to validate all domain access requests.</li>
          <li>Clearly define which methods (view, read, and update) are permitted for each resource and domain to avoid abuse.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Permissive Cross-domain Policy</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-942</li>
                      <li class="card__meta__item">TooPermissiveCorsPostMessage</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Setting targetOrigin to &quot;*&quot; in postMessage may enable malicious parties to intercept the message. Consider using an exact target origin instead.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/CustomElements.js (line : 71)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/CustomElements.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:36</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.postMessage(sentinel, <br /></span><span class="marker">&quot;*&quot;)</span><span class="dataflow__codesuffix">;</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">71:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">      window.<br /></span><span class="marker">postMessage(</span><span class="dataflow__codesuffix">sentinel, &quot;*&quot;);</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">1</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>As a legacy of early web design and site limitations, most web applications default, for security reasons, to a &quot;same origin policy&quot;. This means that browsers can only retrieve data from another site if the two sites share the same domain. In today&#39;s complex online environment, however, sites and applications often need to retrieve data from other domains. This is done under fairly limited conditions through an exception to the same origin policy known as &quot;cross-origin resource sharing&quot;.</p>
          <p>Developers may create definitions of trusted domains that are broader than absolutely necessary, inadvertently opening up wider access than intended. This weakness could result in data exposure or loss, or even allow an attacker to take over the site or application.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Avoid using wildcards for cross-origin resource sharing. Instead, define intended domains explicitly.</li>
          <li>Ensure that your site or app is well defended against cross-site scripting attacks (XSS), which could lead to takeover via an overly permissive cross-domain policy.</li>
          <li>Do not mix secure and insecure protocols when defining cross-domain policies.</li>
          <li>Consider defining a clear approved list to specify which domains will be given resource-level access; use this approved list to validate all domain access requests.</li>
          <li>Clearly define which methods (view, read, and update) are permitted for each resource and domain to avoid abuse.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Server Information Exposure</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-209</li>
                      <li class="card__meta__item">ServerInformationExposure</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>The stack trace from an exception flows into the return value of get_ror_prr_subgrp and is leaked to the user. This may disclose sensitive server information to the attackers.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 626)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">623:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    except KeyError<br /></span><span class="marker block"> as e:
                  l</span><span class="dataflow__codesuffix">ogger.info(f&quot;Wrong parameters received \n ENDING PROCESS&quot;)</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">623:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    except KeyError<br /></span><span class="marker block"> as e:
                  l</span><span class="dataflow__codesuffix">ogger.info(f&quot;Wrong parameters received \n ENDING PROCESS&quot;)</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">625:86</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.error(default_error_message.format(sys.exc_info()[-1].tb_lineno, type(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix">, e))</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">625:90</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.error(default_error_message.format(sys.exc_info()[-1].tb_lineno, type(e), <br /></span><span class="marker">e)</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:66</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify({&quot;message&quot;:f&quot;Wrong parameters received , {<br /></span><span class="marker">e}</span><span class="dataflow__codesuffix">&quot;}) , 500</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify({&quot;message&quot;:<br /></span><span class="marker">f&quot;Wrong parameters received , {e}&quot;}</span><span class="dataflow__codesuffix">) , 500</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify({<br /></span><span class="marker">&quot;message&quot;:f&quot;Wrong parameters received , {e}&quot;}</span><span class="dataflow__codesuffix">) , 500</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify(<br /></span><span class="marker">{&quot;message&quot;:f&quot;Wrong parameters received , {e}&quot;})</span><span class="dataflow__codesuffix"> , 500</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">jsonify(</span><span class="dataflow__codesuffix">{&quot;message&quot;:f&quot;Wrong parameters received , {e}&quot;}) , 500</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">jsonify({&quot;message&quot;:f&quot;Wrong parameters received , {e}&quot;}) , 500</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">626:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">jsonify({&quot;message&quot;:f&quot;Wrong parameters received , {e}&quot;}) , 500</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>When a command to your site or application fails, it should do so gracefully, meaning that the user is informed that there has been a problem, rather than experiencing erratic behavior, such as crashing, hanging, or returning a 404 or similar generic error page.</p>
          <p>In some cases, developers include information in an error message to help pinpoint the source of an error; these may include username, password, application path, stack values, and other internal details. When this weakness is present, if these logs are accessible to an attacker, it may give them clues as to the inner workings of the app, helping them plan a focused attack. For example, clues revealing SQL database details may help plan an SQL injection attack.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Keep error messages to the barest minimum of helpful information that users absolutely need to know.</li>
          <li>Use consistent error messages that do not give attackers clues that they might be on the right track to a successful attack, such as &quot;File not found&quot; or &quot;User name does not exist&quot;.</li>
          <li>Ensure that debugging information is removed from code prior to release.</li>
          <li>Create clear policy for the types of errors that must be logged, which messages will be displayed to users, and which details will be logged for later alerting and debugging.</li>
          <li>When logging error details, never include sensitive information such as passwords.</li>
          <li>Implement naming conventions that will help you flag and defend sensitive information.</li>
          <li>Use dynamic (white box) test techniques to identify conditions that could cause errors and failures and test thoroughly to ensure that the code performs gracefully without revealing sensitive data under these stress conditions.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Server Information Exposure</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-209</li>
                      <li class="card__meta__item">ServerInformationExposure</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>The stack trace from an exception flows into the return value of get_ror_prr_subgrp and is leaked to the user. This may disclose sensitive server information to the attackers.</p>
                      <div class="file-location">Found in: <strong>ror_prr/ror_prr.py (line : 630)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">627:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    except Exception<br /></span><span class="marker block"> as e:
                  l</span><span class="dataflow__codesuffix">ogger.error(default_error_message.format( sys.exc_info()[-1].tb_lineno, type(e), e))</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">627:21</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    except Exception<br /></span><span class="marker block"> as e:
                  l</span><span class="dataflow__codesuffix">ogger.error(default_error_message.format( sys.exc_info()[-1].tb_lineno, type(e), e))</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">628:87</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.error(default_error_message.format( sys.exc_info()[-1].tb_lineno, type(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix">, e))</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">628:91</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        logger.error(default_error_message.format( sys.exc_info()[-1].tb_lineno, type(e), <br /></span><span class="marker">e)</span><span class="dataflow__codesuffix">)</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:50</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify({&quot;message&quot;:f&quot;Exception : {<br /></span><span class="marker">e}</span><span class="dataflow__codesuffix">&quot;}) , 500</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:35</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify({&quot;message&quot;:<br /></span><span class="marker">f&quot;Exception : {e}&quot;}</span><span class="dataflow__codesuffix">) , 500</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:25</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify({<br /></span><span class="marker">&quot;message&quot;:f&quot;Exception : {e}&quot;}</span><span class="dataflow__codesuffix">) , 500</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:24</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return jsonify(<br /></span><span class="marker">{&quot;message&quot;:f&quot;Exception : {e}&quot;})</span><span class="dataflow__codesuffix"> , 500</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">jsonify(</span><span class="dataflow__codesuffix">{&quot;message&quot;:f&quot;Exception : {e}&quot;}) , 500</span></div>
                          
                          <span class="dataflow__step">8</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">jsonify({&quot;message&quot;:f&quot;Exception : {e}&quot;}) , 500</span><span class="dataflow__codesuffix"></span></div>
                          
                          <span class="dataflow__step">9</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">630:16</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        return <br /></span><span class="marker">jsonify({&quot;message&quot;:f&quot;Exception : {e}&quot;}) , 500</span><span class="dataflow__codesuffix"></span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">10</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>When a command to your site or application fails, it should do so gracefully, meaning that the user is informed that there has been a problem, rather than experiencing erratic behavior, such as crashing, hanging, or returning a 404 or similar generic error page.</p>
          <p>In some cases, developers include information in an error message to help pinpoint the source of an error; these may include username, password, application path, stack values, and other internal details. When this weakness is present, if these logs are accessible to an attacker, it may give them clues as to the inner workings of the app, helping them plan a focused attack. For example, clues revealing SQL database details may help plan an SQL injection attack.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Keep error messages to the barest minimum of helpful information that users absolutely need to know.</li>
          <li>Use consistent error messages that do not give attackers clues that they might be on the right track to a successful attack, such as &quot;File not found&quot; or &quot;User name does not exist&quot;.</li>
          <li>Ensure that debugging information is removed from code prior to release.</li>
          <li>Create clear policy for the types of errors that must be logged, which messages will be displayed to users, and which details will be logged for later alerting and debugging.</li>
          <li>When logging error details, never include sensitive information such as passwords.</li>
          <li>Implement naming conventions that will help you flag and defend sensitive information.</li>
          <li>Use dynamic (white box) test techniques to identify conditions that could cause errors and failures and test thoroughly to ensure that the code performs gracefully without revealing sensitive data under these stress conditions.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--medium" data-snyk-test="medium">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--medium"></div>
                      <h2 class="card__title">Open Redirect</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-601</li>
                      <li class="card__meta__item">OR</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--medium">
                      <p>Unsanitized input from the document location flows into replace, where it is used as an URL to redirect the user. This may result in an Open Redirect vulnerability.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/splitContent/jquery.layout.js (line : 1616)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/splitContent/jquery.layout.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1616:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">			if (l.hash) l.replace( l.<br /></span><span class="marker">hash </span><span class="dataflow__codesuffix">); // scrollTo Bookmark</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1616:29</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">			if (l.hash) l.replace( l.<br /></span><span class="marker">hash </span><span class="dataflow__codesuffix">); // scrollTo Bookmark</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1616:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">			if (l.hash) l.replace( <br /></span><span class="marker">l.hash </span><span class="dataflow__codesuffix">); // scrollTo Bookmark</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1616:18</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">			if (l.hash) l.<br /></span><span class="marker">replace(</span><span class="dataflow__codesuffix"> l.hash ); // scrollTo Bookmark</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">3</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>An open redirect attack takes place when a web application redirects the user to an unauthorized and untrusted site. In general, URL redirection refers to the ability of a website or application to redirect users to another site. This is often a benign and useful feature. For example, if a resource has moved to a new location, URL redirection can transfer the user to that location rather than displaying an error message.
          However, this ability can be exploited through social engineering, tricking the user into believing they are accessing one site when, in reality, they are being redirected to a dangerous site, such as a phishing site. Once there, the user may be further tricked into entering credentials or personally identifiable information (PII), believing they are still within the original, trusted domain. Attackers can then use these credentials to gain unauthorized access or leverage the user&#39;s PII for sale or ransom.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>When developing a site or web app, consider implementing a disclaimer page to remind users that they are leaving a secure site.</li>
          <li>Adopt a zero-trust approach in which all input is treated with suspicion.</li>
          <li>Validate all input against deny-lists to ensure it does not contain code to redirect the user. This method is good but inherently incomplete.</li>
          <li>Be aware of all sources of untrusted input being sent to the server that could be used to redirect the user, such as cookies, URL components, filenames, query results, request headers, and more.</li>
          <li>In particular, be aware of potential API calls that could send input indirectly to redirect the user.</li>
          <li>To protect end users, use a firewall to block known malicious sites, train users to recognize basic signs of a phishing attack, and ensure that all network endpoints are patched with the most current updates.</li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Insufficient postMessage Validation</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-20</li>
                      <li class="card__meta__item">InsufficientPostmessageValidation</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>The origin of the received message is not checked. This means any site (even malicious) can send message to this window. If you don&#x27;t expect this, consider checking the origin of sender.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents-lite.js (line : 624)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents-lite.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">624:53</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">        window.addEventListener(&quot;message&quot;, function(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span><span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">0</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>postMessage is a feature to perform cross-origin communication between JavaScript Window objects. This can be done by:</p>
          <ul>
          <li><p>The sender using the <code>targetWindow.postMessage(message, targetOrigin)</code> to send a message to the <code>targetWindow</code> but only if the origin in that window matches <code>targetOrigin</code> (or if targetOrigin is set to the special value <code>*</code>);</p>
          </li>
          <li><p>The receiver listening for the message event in the window object.</p>
          </li>
          </ul>
          <p>However, if no validation is done by the receiver, this could allow any window to send arbitrary data to the handler. This vulnerability could be leveraged by an attacker to disclose sensitive data to a malicious origin, or perform actions on a vicitim&#39;s behalf.</p>
          <p>Example:</p>
          <pre><code>
          window.addEventListener(&quot;message&quot;, (event) =&gt; {
              // DANGEROUS: No validation of origin
              doStuff(event.data);
          });
          </code></pre>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Adopt a zero-trust model in which all input is considered potentially suspect.</li>
          <li>Specify the targetOrigin instead of designating a wildcard <code>*</code>.</li>
          </ul>
          <p>Example:</p>
          <pre><code>window.addEventListener(&quot;message&quot;, (event) =&gt; {
              if (event.origin !== &quot;http://example.org&quot;) // SAFE: origin checked
                  return;
          
              console.log(event.data)
          });
          </code></pre>
          <h2 id="references">References</h2>
          <ul>
          <li><a href="https://blog.yeswehack.com/yeswerhackers/introduction-postmessage-vulnerabilities/">Introduction to postMessage() Vulnerabilities</a></li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Insufficient postMessage Validation</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-20</li>
                      <li class="card__meta__item">InsufficientPostmessageValidation</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>The origin of the received message is not checked. This means any site (even malicious) can send message to this window. If you don&#x27;t expect this, consider checking the origin of sender.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents.js (line : 5479)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/webcomponents.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">5479:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    window.addEventListener(&quot;message&quot;, function(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span><span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">0</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>postMessage is a feature to perform cross-origin communication between JavaScript Window objects. This can be done by:</p>
          <ul>
          <li><p>The sender using the <code>targetWindow.postMessage(message, targetOrigin)</code> to send a message to the <code>targetWindow</code> but only if the origin in that window matches <code>targetOrigin</code> (or if targetOrigin is set to the special value <code>*</code>);</p>
          </li>
          <li><p>The receiver listening for the message event in the window object.</p>
          </li>
          </ul>
          <p>However, if no validation is done by the receiver, this could allow any window to send arbitrary data to the handler. This vulnerability could be leveraged by an attacker to disclose sensitive data to a malicious origin, or perform actions on a vicitim&#39;s behalf.</p>
          <p>Example:</p>
          <pre><code>
          window.addEventListener(&quot;message&quot;, (event) =&gt; {
              // DANGEROUS: No validation of origin
              doStuff(event.data);
          });
          </code></pre>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Adopt a zero-trust model in which all input is considered potentially suspect.</li>
          <li>Specify the targetOrigin instead of designating a wildcard <code>*</code>.</li>
          </ul>
          <p>Example:</p>
          <pre><code>window.addEventListener(&quot;message&quot;, (event) =&gt; {
              if (event.origin !== &quot;http://example.org&quot;) // SAFE: origin checked
                  return;
          
              console.log(event.data)
          });
          </code></pre>
          <h2 id="references">References</h2>
          <ul>
          <li><a href="https://blog.yeswehack.com/yeswerhackers/introduction-postmessage-vulnerabilities/">Introduction to postMessage() Vulnerabilities</a></li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Insufficient postMessage Validation</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-20</li>
                      <li class="card__meta__item">InsufficientPostmessageValidation</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>The origin of the received message is not checked. This means any site (even malicious) can send message to this window. If you don&#x27;t expect this, consider checking the origin of sender.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/HTMLImports.js (line : 60)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/HTMLImports.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    window.addEventListener(&quot;message&quot;, function(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span><span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">0</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>postMessage is a feature to perform cross-origin communication between JavaScript Window objects. This can be done by:</p>
          <ul>
          <li><p>The sender using the <code>targetWindow.postMessage(message, targetOrigin)</code> to send a message to the <code>targetWindow</code> but only if the origin in that window matches <code>targetOrigin</code> (or if targetOrigin is set to the special value <code>*</code>);</p>
          </li>
          <li><p>The receiver listening for the message event in the window object.</p>
          </li>
          </ul>
          <p>However, if no validation is done by the receiver, this could allow any window to send arbitrary data to the handler. This vulnerability could be leveraged by an attacker to disclose sensitive data to a malicious origin, or perform actions on a vicitim&#39;s behalf.</p>
          <p>Example:</p>
          <pre><code>
          window.addEventListener(&quot;message&quot;, (event) =&gt; {
              // DANGEROUS: No validation of origin
              doStuff(event.data);
          });
          </code></pre>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Adopt a zero-trust model in which all input is considered potentially suspect.</li>
          <li>Specify the targetOrigin instead of designating a wildcard <code>*</code>.</li>
          </ul>
          <p>Example:</p>
          <pre><code>window.addEventListener(&quot;message&quot;, (event) =&gt; {
              if (event.origin !== &quot;http://example.org&quot;) // SAFE: origin checked
                  return;
          
              console.log(event.data)
          });
          </code></pre>
          <h2 id="references">References</h2>
          <ul>
          <li><a href="https://blog.yeswehack.com/yeswerhackers/introduction-postmessage-vulnerabilities/">Introduction to postMessage() Vulnerabilities</a></li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Insufficient postMessage Validation</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-20</li>
                      <li class="card__meta__item">InsufficientPostmessageValidation</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>The origin of the received message is not checked. This means any site (even malicious) can send message to this window. If you don&#x27;t expect this, consider checking the origin of sender.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/MutationObserver.js (line : 60)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/MutationObserver.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    window.addEventListener(&quot;message&quot;, function(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span><span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">0</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>postMessage is a feature to perform cross-origin communication between JavaScript Window objects. This can be done by:</p>
          <ul>
          <li><p>The sender using the <code>targetWindow.postMessage(message, targetOrigin)</code> to send a message to the <code>targetWindow</code> but only if the origin in that window matches <code>targetOrigin</code> (or if targetOrigin is set to the special value <code>*</code>);</p>
          </li>
          <li><p>The receiver listening for the message event in the window object.</p>
          </li>
          </ul>
          <p>However, if no validation is done by the receiver, this could allow any window to send arbitrary data to the handler. This vulnerability could be leveraged by an attacker to disclose sensitive data to a malicious origin, or perform actions on a vicitim&#39;s behalf.</p>
          <p>Example:</p>
          <pre><code>
          window.addEventListener(&quot;message&quot;, (event) =&gt; {
              // DANGEROUS: No validation of origin
              doStuff(event.data);
          });
          </code></pre>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Adopt a zero-trust model in which all input is considered potentially suspect.</li>
          <li>Specify the targetOrigin instead of designating a wildcard <code>*</code>.</li>
          </ul>
          <p>Example:</p>
          <pre><code>window.addEventListener(&quot;message&quot;, (event) =&gt; {
              if (event.origin !== &quot;http://example.org&quot;) // SAFE: origin checked
                  return;
          
              console.log(event.data)
          });
          </code></pre>
          <h2 id="references">References</h2>
          <ul>
          <li><a href="https://blog.yeswehack.com/yeswerhackers/introduction-postmessage-vulnerabilities/">Introduction to postMessage() Vulnerabilities</a></li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Insufficient postMessage Validation</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-20</li>
                      <li class="card__meta__item">InsufficientPostmessageValidation</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>The origin of the received message is not checked. This means any site (even malicious) can send message to this window. If you don&#x27;t expect this, consider checking the origin of sender.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/bower_components/webcomponentsjs/CustomElements.js (line : 60)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/bower_components/webcomponentsjs/CustomElements.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">60:49</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">    window.addEventListener(&quot;message&quot;, function(<br /></span><span class="marker">e)</span><span class="dataflow__codesuffix"> {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span><span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">0</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h2 id="details">Details</h2>
          <p>postMessage is a feature to perform cross-origin communication between JavaScript Window objects. This can be done by:</p>
          <ul>
          <li><p>The sender using the <code>targetWindow.postMessage(message, targetOrigin)</code> to send a message to the <code>targetWindow</code> but only if the origin in that window matches <code>targetOrigin</code> (or if targetOrigin is set to the special value <code>*</code>);</p>
          </li>
          <li><p>The receiver listening for the message event in the window object.</p>
          </li>
          </ul>
          <p>However, if no validation is done by the receiver, this could allow any window to send arbitrary data to the handler. This vulnerability could be leveraged by an attacker to disclose sensitive data to a malicious origin, or perform actions on a vicitim&#39;s behalf.</p>
          <p>Example:</p>
          <pre><code>
          window.addEventListener(&quot;message&quot;, (event) =&gt; {
              // DANGEROUS: No validation of origin
              doStuff(event.data);
          });
          </code></pre>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li>Adopt a zero-trust model in which all input is considered potentially suspect.</li>
          <li>Specify the targetOrigin instead of designating a wildcard <code>*</code>.</li>
          </ul>
          <p>Example:</p>
          <pre><code>window.addEventListener(&quot;message&quot;, (event) =&gt; {
              if (event.origin !== &quot;http://example.org&quot;) // SAFE: origin checked
                  return;
          
              console.log(event.data)
          });
          </code></pre>
          <h2 id="references">References</h2>
          <ul>
          <li><a href="https://blog.yeswehack.com/yeswerhackers/introduction-postmessage-vulnerabilities/">Introduction to postMessage() Vulnerabilities</a></li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Unsafe JQuery Plugin</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79,CWE-116</li>
                      <li class="card__meta__item">UnsafeJqueryPlugin</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>Unsanitized input to JQuery plugin from options flows into $, where it may be evaluated as HTML. If the input is intended to be used as a selector, then a JQuery method that only accepts selectors should be used. If the input is intended to be used as HTML, the developer needs to ensure that it&#x27;s well documented that the user is responsible for sanitizing the input.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/vendor/jquery-ui/jquery-ui.js (line : 1178)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/vendor/jquery-ui/jquery-ui.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1169:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">$.fn.position &#x3D; function( <br /></span><span class="marker">options </span><span class="dataflow__codesuffix">) {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1169:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">$.fn.position &#x3D; function( <br /></span><span class="marker">options </span><span class="dataflow__codesuffix">) {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1170:8</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	if ( !<br /></span><span class="marker">options </span><span class="dataflow__codesuffix">|| !options.of ) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1170:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	if ( !options || !<br /></span><span class="marker">options.</span><span class="dataflow__codesuffix">of ) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1175:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	options &#x3D; $.extend( {}, <br /></span><span class="marker">options </span><span class="dataflow__codesuffix">);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1175:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	options &#x3D; $.<br /></span><span class="marker">extend(</span><span class="dataflow__codesuffix"> {}, options );</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1178:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">		target &#x3D; $( <br /></span><span class="marker">options.</span><span class="dataflow__codesuffix">of ),</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1178:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">		target &#x3D; $( <br /></span><span class="marker">options.of </span><span class="dataflow__codesuffix">),</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1178:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">		target &#x3D; <br /></span><span class="marker">$(</span><span class="dataflow__codesuffix"> options.of ),</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h1 id="details">Details</h1>
          <p>Popular frameworks, such as JQuery, may be extended by with third party plugins.
          A third party plug-in might, for example, add an additional function to the JQuery framework.
          Such a function might accept parameters from the client (the developer using the plugin).</p>
          <p>Clients of these plugins do not know the details of the plugin&#39;s implementation, so the inputs and outputs should be documented by the plugin developer.</p>
          <p>Of particular importance, the plugin developer should document whether a particular input should be sanitized by the client.</p>
          <p>The JQuery framework exposes an API that consists of the following:</p>
          <ul>
          <li>Methods that use some input to select an element within the DOM</li>
          <li>Methods that use some input to mutate the DOM</li>
          </ul>
          <p>As a result, a plugin might, for example, take user input and write it to the DOM without sanitizing it internally, expecting the client to have performed the necessary sanitization.
          This case may lead to cross-site scripting vulnerabilties.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li><p>Document which inputs should be sanitized</p>
          <ul>
          <li>It&#39;s recommended that JQuery plugin developers thoroughly document any inputs that may lead to cross-side scripting attacks.</li>
          </ul>
          </li>
          <li><p>Avoid ambiguous JQuery APIs
          In addition to the onus of documentation, JQuery plugin developers should take particular care to ensure that user input is not handled in unexpected ways.</p>
          <ul>
          <li>JQuery has a very flexible API, and there are some methods that either perform a selection OR mutation, depending on the type of input given.</li>
          <li>As a result, a plugin developer may intend their plugin to accept user input to perform a selection, but certain user inputs may instead perform dynamic HTML construction.</li>
          <li>If user input is intended to only be used to perform selection, a method that only performs selection should be used</li>
          </ul>
          </li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
          <div class="card card--vuln  disclosure--not-new severity--low" data-snyk-test="low">
              <header class="card__header">
                  <div class="card__header__main">
                      <div class="severity-icon severity-icon--low"></div>
                      <h2 class="card__title">Unsafe JQuery Plugin</h2>
                      <div class="card__actions">
                          <span class="card__action card-dataflow is-selected" onclick="toggleCardView(event)">Data Flow</span>
                          <span class="card__action card-fix" onclick="toggleCardView(event)">Fix Analysis</span>
                      </div>
                  </div>
                  <ul class="card__meta">
                      <li class="card__meta__item">SNYK-CODE</li>
                      <li class="card__meta__item">CWE-79,CWE-116</li>
                      <li class="card__meta__item">UnsafeJqueryPlugin</li>
                  </ul>
              </header>
              <div class="card__section">
                  <div class="card__summary severity--low">
                      <p>Unsanitized input to JQuery plugin from options flows into $, where it may be evaluated as HTML. If the input is intended to be used as a selector, then a JQuery method that only accepts selectors should be used. If the input is intended to be used as HTML, the developer needs to ensure that it&#x27;s well documented that the user is responsible for sanitizing the input.</p>
                      <div class="file-location">Found in: <strong>grails-app/assets/javascripts/splitContent/jquery-ui.js (line : 1147)</strong></div>    
                  </div>
                  <div class="card__panel dataflow">
                      <h2 class="card__panel__heading"><span class="heading-char">⇣</span> Data Flow</h2>
                      <div class="dataflow__filename"> grails-app/assets/javascripts/splitContent/jquery-ui.js</div>
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1138:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">$.fn.position &#x3D; function( <br /></span><span class="marker">options </span><span class="dataflow__codesuffix">) {</span></div>
                          <span class="dataflow__badge" title="Data is 'tainted' if it comes from an insecure source such as a file, the network, or the user. This tainted data is passed to a sensitive sink, as described below.">Source</span>
                          <span class="dataflow__step">0</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1138:27</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">$.fn.position &#x3D; function( <br /></span><span class="marker">options </span><span class="dataflow__codesuffix">) {</span></div>
                          
                          <span class="dataflow__step">1</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1139:8</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	if ( !<br /></span><span class="marker">options </span><span class="dataflow__codesuffix">|| !options.of ) {</span></div>
                          
                          <span class="dataflow__step">2</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1139:20</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	if ( !options || !<br /></span><span class="marker">options.</span><span class="dataflow__codesuffix">of ) {</span></div>
                          
                          <span class="dataflow__step">3</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1144:26</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	options &#x3D; $.extend( {}, <br /></span><span class="marker">options </span><span class="dataflow__codesuffix">);</span></div>
                          
                          <span class="dataflow__step">4</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1144:14</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">	options &#x3D; $.<br /></span><span class="marker">extend(</span><span class="dataflow__codesuffix"> {}, options );</span></div>
                          
                          <span class="dataflow__step">5</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1147:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">		target &#x3D; $( <br /></span><span class="marker">options.</span><span class="dataflow__codesuffix">of ),</span></div>
                          
                          <span class="dataflow__step">6</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1147:15</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">		target &#x3D; $( <br /></span><span class="marker">options.of </span><span class="dataflow__codesuffix">),</span></div>
                          
                          <span class="dataflow__step">7</span>
                      </div>
                      
                      <div class="dataflow__item">
                          <span class="dataflow__lineno" title="line:column">1147:12</span>
                          <div class="dataflow__code"><span class="dataflow__codeprefix">		target &#x3D; <br /></span><span class="marker">$(</span><span class="dataflow__codesuffix"> options.of ),</span></div>
                          <span class="dataflow__badge" title="Sinks are the operations that must receive clean data and that you wouldn't want an attacker to be able to manipulate.">Sink</span>
                          <span class="dataflow__step">8</span>
                      </div>
                  </div>
                  <div class="card__panel fix-analysis">
                      <h2 class="card__panel__heading"><span class="heading-char">✓</span> Fix Analysis</h2>
                      <div class="card__panel__markdown"><h1 id="details">Details</h1>
          <p>Popular frameworks, such as JQuery, may be extended by with third party plugins.
          A third party plug-in might, for example, add an additional function to the JQuery framework.
          Such a function might accept parameters from the client (the developer using the plugin).</p>
          <p>Clients of these plugins do not know the details of the plugin&#39;s implementation, so the inputs and outputs should be documented by the plugin developer.</p>
          <p>Of particular importance, the plugin developer should document whether a particular input should be sanitized by the client.</p>
          <p>The JQuery framework exposes an API that consists of the following:</p>
          <ul>
          <li>Methods that use some input to select an element within the DOM</li>
          <li>Methods that use some input to mutate the DOM</li>
          </ul>
          <p>As a result, a plugin might, for example, take user input and write it to the DOM without sanitizing it internally, expecting the client to have performed the necessary sanitization.
          This case may lead to cross-site scripting vulnerabilties.</p>
          <h2 id="best-practices-for-prevention">Best practices for prevention</h2>
          <ul>
          <li><p>Document which inputs should be sanitized</p>
          <ul>
          <li>It&#39;s recommended that JQuery plugin developers thoroughly document any inputs that may lead to cross-side scripting attacks.</li>
          </ul>
          </li>
          <li><p>Avoid ambiguous JQuery APIs
          In addition to the onus of documentation, JQuery plugin developers should take particular care to ensure that user input is not handled in unexpected ways.</p>
          <ul>
          <li>JQuery has a very flexible API, and there are some methods that either perform a selection OR mutation, depending on the type of input given.</li>
          <li>As a result, a plugin developer may intend their plugin to accept user input to perform a selection, but certain user inputs may instead perform dynamic HTML construction.</li>
          <li>If user input is intended to only be used to perform selection, a method that only performs selection should be used</li>
          </ul>
          </li>
          </ul>
          </div>
                  </div>
              </div>
          </div>
        </div>
    </div>
  </main>
</body>
<script>
  // collapse vulns in remediations
  const remediations = document.querySelectorAll(".js-remediation");
  remediations.forEach((remediation) => {
    remediation.parentElement.classList.toggle("shown");
    remediation.addEventListener("click", remediationClick);
  })

  // hide all panes
  const allPanes = document.querySelectorAll(`[data-pane]`);
  allPanes.forEach((pane) => {
    pane.classList.remove('shown');
  });
  // set first nav item as active & un-hide it's pane
  const remediationNav = document.querySelectorAll(".js-nav");
  remediationNav.forEach((nav) => {
    nav.addEventListener("click", navClick);
  })
  if (remediationNav && remediationNav.length > 0) {
    remediationNav[0].classList.add('active');
    const targetPaneData = remediationNav[0].dataset && remediationNav[0].dataset.toggle;
    if (targetPaneData) {
      showPane(targetPaneData);
    }
  }

  function remediationClick() {
    this.parentElement.classList.toggle("shown");
  }

  function navClick() {
    const remediationNav = document.querySelectorAll(".js-nav");
    remediationNav.forEach((nav) => {
      nav.classList.remove('active');
    });
    this.classList.toggle('active');
    const targetPaneData = this.dataset && this.dataset.toggle;
    if (targetPaneData) {
      showPane(targetPaneData);
    }
  }

  function showPane(targetPaneData) {
    const targetPanes = document.querySelectorAll(`[data-pane='${targetPaneData}']`);
    if (targetPanes) {
      const allPanes = document.querySelectorAll(`[data-pane]`);
      allPanes.forEach((pane) => {
        pane.classList.remove('shown');
      });
      targetPanes[0].classList.add('shown');
    }
  }

// https://gomakethings.com/how-to-get-the-closest-parent-element-with-a-matching-selector-using-vanilla-javascript/
  function getClosest(element, selector) {
    for ( ; element && element !== document; element = element.parentNode ) {
      if ( element.matches( selector ) ) return element;
    }
    return null;
  }

  function toggleCardView(event) {
    var clickedButton = event.target;
    var card = this.getClosest(clickedButton, '.card');
    if (clickedButton.classList.contains('card-fix')){
      if (clickedButton.classList.contains('is-selected')) 
        return;
      clickedButton.classList.add('is-selected');
      clickedButton.previousElementSibling.classList.remove('is-selected');
      card.classList.add('show-fix');
    } else {
      if (clickedButton.classList.contains('is-selected')) 
        return;
      clickedButton.classList.add('is-selected');
      clickedButton.nextElementSibling.classList.remove('is-selected');
      card.classList.remove('show-fix');
    }
  }
</script>
</html>